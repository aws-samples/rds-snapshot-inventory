# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
# SPDX-License-Identifier: MIT-0
AWSTemplateFormatVersion: 2010-09-09
Description: >-
  Stack that will deployed to analyze snapshots
Metadata:
  AWS::CloudFormation::Interface:
    ParameterGroups:
      - Label:
          default: "Common Parameters Configuration"
        Parameters:
          - DeploymentType
          - ResourceRegions
          - ManagementAccountId
          - ExcludedAccounts
          - TemplateVersion
          - SourceCodeBucketPrefix
      - Label:
          default: "Glue Parameters Configuration"
        Parameters:
          - GlueDatabaseName
      - Label:
          default: "Event Bridge Schedule Parameters Configuration"
        Parameters:
          - ScheduleTimeZone
      - Label:
          default: "Quicksight Dashboard Parameters Configuration"
        Parameters:
          - QuicksightUserName
          - QuicksightIdentityRegion
          - DashboardName
      - Label:
          default: "[DO NOT CHANGE] Internal Configuration"
        Parameters:
          - AthenaQueryRsltBucketPrefix
          - RdsInsRawGlueTbl
          - RdsClsRawGlueTbl
          - RdsInsFormtdGlueTbl
          - RdsClsFormtdGlueTbl
          - RdsInsFormtArchGlueTbl
          - RdsClsFormtArchGlueTbl       
    ParameterLabels:
      GlueDatabaseName:
        default: "Glue Database name"
      AthenaQueryRsltBucketPrefix:
        default: "Athena Query Result S3 Bucket Prefix - DO NOT CHANGE"  
      RdsInsRawGlueTbl:
        default: "RDS Instance Raw Glue Table - DO NOT CHANGE"
      RdsClsRawGlueTbl:
        default: "RDS Cluster Raw Glue Table - DO NOT CHANGE"
      RdsInsFormtdGlueTbl:
        default: "RDS Instance Formated Glue Table - DO NOT CHANGE"
      RdsClsFormtdGlueTbl:
        default: "RDS Cluster Formated Glue Table - DO NOT CHANGE"
      RdsInsFormtArchGlueTbl:
        default: "RDS Instance Formatted Data Archive Glue Table - DO NOT CHANGE"
      RdsClsFormtArchGlueTbl:
        default: "RDS Cluster Formatted Data Archive Glue Table - DO NOT CHANGE"
      ScheduleTimeZone:
        default: "Schedule Timezone"              
      QuicksightUserName:
        default: "User name of QuickSight user. Leave this parameter empty if you DO NOT want QuickSight Dashboard created for this solution."
      QuicksightIdentityRegion:
        default: "QuickSight Identity Region. This value will be auto dervied - DO NOT CHANGE"
      DashboardName:
        default: "Quicksight Dashboard Name. Leave this parameter empty if you DO NOT want QuickSight Dashboard created for this solution."      
Parameters:
  DeploymentType:
    Type: String
    AllowedValues:
      - ORGANIZATION
      - CURRENT_ACCOUNT
  ResourceRegions:
    Type: CommaDelimitedList
  ManagementAccountId:
    Type: String
    Description: "Management or Payer AWS Account Id"
    AllowedPattern: '\d{12}'
  ExcludedAccounts:
    Type: CommaDelimitedList
    Description: "Comma separated list of AWS Account Ids to be excluded from the orphan snapshot process"
    Default: "111111111111,222222222222"
  TemplateVersion:
    Type: String
    Description: "Template Version"
  SourceCodeBucketPrefix:
    Type: String
    Description: "Source Code Bucket Prefix, example: snapshot-insight-source-code"  
  GlueDatabaseName:
    Type: String
    Description: "Unique Glue Database Name"
  ScheduleTimeZone:
    Type: String
    Description: "Schedule Timezone"
    Default: Asia/Singapore
    AllowedValues:
      - UTC
      - Asia/Singapore
      - America/New_York
      - Europe/London     
  QuicksightUserName:
    Description: See https://quicksight.aws.amazon.com/sn/admin#users
    Type: String  
  DashboardName:
    Default: Orphan Resource Insight
    Description: 'Quicksight Dashboard Name'
    Type: String
  #DO NOT CHANGE BELOW PARAMETERS
  QuicksightIdentityRegion:
    Type: String
    Description: "[DO NOT CHANGE]"
  AthenaQueryRsltBucketPrefix:
    Type: String
    Description: "[DO NOT CHANGE]" 
  RdsInsRawGlueTbl:
    Type: String
    Description: "[DO NOT CHANGE]"
    Default: rds_ins_raw
  RdsClsRawGlueTbl:
    Type: String
    Description: "[DO NOT CHANGE]"
    Default: rds_cls_raw
  RdsInsFormtdGlueTbl:
    Type: String
    Description: "[DO NOT CHANGE]"
    Default: rds_ins
  RdsClsFormtdGlueTbl:
    Type: String
    Description: "[DO NOT CHANGE]"
    Default: rds_cls
  RdsInsFormtArchGlueTbl:
    Type: String
    Description: "[DO NOT CHANGE]"
    Default: rds_ins_formatted_archive
  RdsClsFormtArchGlueTbl:
    Type: String
    Description: "[DO NOT CHANGE]"
    Default: rds_cls_formatted_archive
Conditions:
  isCurrentAccountDeployment: !Equals [!Ref DeploymentType, CURRENT_ACCOUNT]
  NeedDashboard: !Not [!Equals [!Ref QuicksightUserName, ""]] 
Outputs:
  S3BucketRawArn:
    Description: S3 Bucket Raw Arn Details to be passed as parameter at Management Stack
    Value: !GetAtt S3BucketRaw.Arn
  StepFunctionsSnapshotInsightRole: 
    Description: Step Function Role Arn Details to be passed as parameter at Management Stack
    Value: !GetAtt StepFunctionsSnapshotInsightRole.Arn

Resources:
  #SSM Parameter Store
  SnapshotInsightDeploymentType:
    Type: AWS::SSM::Parameter
    Properties:
      Name: /blog/snapshot-insight/deployment-type
      Type: String
      Value: !Ref DeploymentType
  SnapshotInsightCurrentAccount:
    Type: AWS::SSM::Parameter
    Properties:
      Name: /blog/snapshot-insight/current-account-id
      Type: String
      Value: !Ref AWS::AccountId
  SnapshotInsightExcludedAccounts:
    Type: AWS::SSM::Parameter
    Condition: isCurrentAccountDeployment
    Properties:
      Name: /blog/snapshot-insight/excluded-account-ids
      Type: StringList
      Value: !Join [",", !Split [',', !Join [',', !Ref ExcludedAccounts]]]
  SnapshotInsightRegions:
    Type: AWS::SSM::Parameter
    Properties:
      Name: /blog/snapshot-insight/deployment-regions
      Type: StringList
      Value: !Join [",", !Split [',', !Join [',', !Ref ResourceRegions]]]
  #S3 Buckets
  S3BucketRaw:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub snapshot-insight-raw-${AWS::AccountId}-${AWS::Region}
      VersioningConfiguration:
        Status: Enabled
  S3BucketFormatted:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub snapshot-insight-formatted-${AWS::AccountId}-${AWS::Region}
      VersioningConfiguration:
        Status: Enabled            
  S3BucketArchive:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub snapshot-insight-archive-${AWS::AccountId}-${AWS::Region}
      VersioningConfiguration:
        Status: Enabled
  #Glue DB
  GlueDatabaseSnapshotInsight:
    Type: AWS::Glue::Database
    Properties:
      CatalogId: !Ref AWS::AccountId
      DatabaseInput:
        Description: Aws Snapshot Insight Database
        Name: !Ref GlueDatabaseName
  #Glue Raw Tables
  GlueTableSnapshotInsightRdsInsRaw:
    Type: AWS::Glue::Table
    Properties:
      CatalogId: !Ref AWS::AccountId
      DatabaseName: !Ref GlueDatabaseSnapshotInsight
      TableInput:
        Description: Orphan Snapshot RDS Instance Raw data Table
        Name: !Ref RdsInsRawGlueTbl
        TableType: EXTERNAL_TABLE
        Parameters:
          CrawlerSchemaSerializerVersion: 1.0
          CrawlerSchemaDeserializerVersion: 1.0
          compressionType: none
          classification: json
          typeOfData: file
        PartitionKeys:
          - Name: par_year
            Type: string
          - Name: par_month
            Type: string
          - Name: par_day
            Type: string
          - Name: par_sf_exc_id
            Type: string
          - Name: par_account_id
            Type: string
          - Name: par_region
            Type: string     
        StorageDescriptor:
          Columns:
            - Name: aws_account
              Type: string
            - Name: account_name
              Type: string  
            - Name: region
              Type: string
            - Name: ops
              Type: string
          Location: !Sub s3://${S3BucketRaw}/${RdsInsRawGlueTbl}/
          InputFormat: com.amazon.ionhiveserde.formats.IonInputFormat      
          OutputFormat: com.amazon.ionhiveserde.formats.IonOutputFormat
          SerdeInfo:
            SerializationLibrary: com.amazon.ionhiveserde.IonHiveSerDe
            Parameters:
              paths: aws_account,lambda_output,ops,region 
  GlueTableSnapshotInsightRdsClsRaw:
    Type: AWS::Glue::Table
    Properties:
      CatalogId: !Ref AWS::AccountId
      DatabaseName: !Ref GlueDatabaseSnapshotInsight
      TableInput:
        Description: Orphan Snapshot RDS Cluster Raw data Table
        Name: !Ref RdsClsRawGlueTbl
        TableType: EXTERNAL_TABLE
        Parameters:
          CrawlerSchemaSerializerVersion: 1.0
          CrawlerSchemaDeserializerVersion: 1.0
          compressionType: none
          classification: json
          typeOfData: file
        PartitionKeys:
          - Name: par_year
            Type: string
          - Name: par_month
            Type: string
          - Name: par_day
            Type: string
          - Name: par_sf_exc_id
            Type: string
          - Name: par_account_id
            Type: string
          - Name: par_region
            Type: string     
        StorageDescriptor:
          Columns:
            - Name: aws_account
              Type: string
            - Name: account_name
              Type: string  
            - Name: region
              Type: string
            - Name: ops
              Type: string
          Location: !Sub s3://${S3BucketRaw}/${RdsClsRawGlueTbl}/
          InputFormat: com.amazon.ionhiveserde.formats.IonInputFormat      
          OutputFormat: com.amazon.ionhiveserde.formats.IonOutputFormat
          SerdeInfo:
            SerializationLibrary: com.amazon.ionhiveserde.IonHiveSerDe
            Parameters:
              paths: aws_account,lambda_output,ops,region
  #Glue FormattedTables
  GlueTableSnapshotInsightRdsInsFormatted:
    Type: AWS::Glue::Table
    Properties:
      CatalogId: !Ref AWS::AccountId
      DatabaseName: !Ref GlueDatabaseSnapshotInsight
      TableInput:
        Description: Orphan Snapshot Rds Instance Snapshot Formatted data Table
        Name: !Ref RdsInsFormtdGlueTbl
        TableType: EXTERNAL_TABLE
        Parameters:
          CrawlerSchemaSerializerVersion: 1.0
          partition_filtering.enabled	: "true"
          CrawlerSchemaDeserializerVersion: 1.0
          compressionType: none
          classification: parquet
          typeOfData: file
        PartitionKeys:
          - Name: par_account_id
            Type: string
          - Name: par_region
            Type: string   
        StorageDescriptor:
          Columns:
            - Name: aws_account
              Type: string
            - Name: account_name
              Type: string  
            - Name: region
              Type: string
            - Name: ops
              Type: string
            - Name: lambda_output.statuscode
              Type: int
            - Name: par_year
              Type: string
            - Name: par_month
              Type: string
            - Name: par_day
              Type: string
            - Name: par_sf_exc_id
              Type: string
            - Name: snapshot.dbsnapshotidentifier
              Type: string
            - Name: snapshot.dbinstanceidentifier
              Type: string
            - Name: snapshot.snapshotcreatetime
              Type: string
            - Name: snapshot.engine
              Type: string
            - Name: snapshot.allocatedstorage
              Type: int
            - Name: snapshot.status
              Type: string
            - Name: snapshot.port
              Type: int
            - Name: snapshot.availabilityzone
              Type: string
            - Name: snapshot.vpcid
              Type: string
            - Name: snapshot.instancecreatetime
              Type: string
            - Name: snapshot.masterusername
              Type: string
            - Name: snapshot.engineversion
              Type: string  
          Location: !Sub s3://${S3BucketFormatted}/${RdsInsFormtdGlueTbl}/
          InputFormat: org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat     
          OutputFormat: org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat
          SerdeInfo:
            SerializationLibrary: org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe
            Parameters:
              serialization.format: 1
  GlueTableSnapshotInsightRdsClsFormatted:
    Type: AWS::Glue::Table
    Properties:
      CatalogId: !Ref AWS::AccountId
      DatabaseName: !Ref GlueDatabaseSnapshotInsight
      TableInput:
        Description: Orphan Snapshot RDS Cluster Formatted data Table
        Name: !Ref RdsClsFormtdGlueTbl
        TableType: EXTERNAL_TABLE
        Parameters:
          CrawlerSchemaSerializerVersion: 1.0
          partition_filtering.enabled	: "true"
          CrawlerSchemaDeserializerVersion: 1.0
          compressionType: none
          classification: parquet
          typeOfData: file
        PartitionKeys:
          - Name: par_account_id
            Type: string
          - Name: par_region
            Type: string
        StorageDescriptor:
          Columns:
            - Name: aws_account
              Type: string
            - Name: account_name
              Type: string  
            - Name: region
              Type: string
            - Name: ops
              Type: string
            - Name: lambda_output.statuscode
              Type: int
            - Name: par_year
              Type: string
            - Name: par_month
              Type: string
            - Name: par_day
              Type: string
            - Name: par_sf_exc_id
              Type: string
            # - Name: par_region
            #   Type: string  
            - Name: snapshot.dbclustersnapshotidentifier
              Type: string
            - Name: snapshot.dbclusteridentifier
              Type: string
            - Name: snapshot.snapshotcreatetime
              Type: string
            - Name: snapshot.engine
              Type: string
            - Name: snapshot.enginemode
              Type: string
            - Name: snapshot.allocatedstorage
              Type: int
            - Name: snapshot.status
              Type: string
            - Name: snapshot.port
              Type: int
            - Name: snapshot.vpcid
              Type: string
            - Name: snapshot.clustercreatetime
              Type: string
            - Name: volume.masterusername
              Type: string
            - Name: volume.engineversion
              Type: string  
          Location: !Sub s3://${S3BucketFormatted}/${RdsClsFormtdGlueTbl}/
          InputFormat: org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat     
          OutputFormat: org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat
          SerdeInfo:
            SerializationLibrary: org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe
            Parameters:
              serialization.format: 1
  #Glue Formatted Data Archive Tables
  GlueTableSnapshotInsightRdsInsFormtArch:
    Type: AWS::Glue::Table
    Properties:
      CatalogId: !Ref AWS::AccountId
      DatabaseName: !Ref GlueDatabaseSnapshotInsight
      TableInput:
        Description: Orphan Snapshot Rds Instance Snapshot Formatted data Archive Table
        Name: !Ref RdsInsFormtArchGlueTbl
        TableType: EXTERNAL_TABLE
        Parameters:
          CrawlerSchemaSerializerVersion: 1.0
          CrawlerSchemaDeserializerVersion: 1.0
          partition_filtering.enabled	: "true"
          compressionType: none
          classification: parquet
          typeOfData: file
        PartitionKeys:
          - Name: job_run_dt
            Type: string
          - Name: par_account_id
            Type: string
          - Name: par_region
            Type: string   
        StorageDescriptor:
          Columns:
            - Name: aws_account
              Type: string
            - Name: account_name
              Type: string  
            - Name: region
              Type: string
            - Name: ops
              Type: string
            - Name: lambda_output.statuscode
              Type: int
            - Name: par_year
              Type: string
            - Name: par_month
              Type: string
            - Name: par_day
              Type: string
            - Name: par_sf_exc_id
              Type: string
            - Name: snapshot.dbsnapshotidentifier
              Type: string
            - Name: snapshot.dbinstanceidentifier
              Type: string
            - Name: snapshot.snapshotcreatetime
              Type: string
            - Name: snapshot.engine
              Type: string
            - Name: snapshot.allocatedstorage
              Type: int
            - Name: snapshot.status
              Type: string
            - Name: snapshot.port
              Type: int
            - Name: snapshot.availabilityzone
              Type: string
            - Name: snapshot.vpcid
              Type: string
            - Name: snapshot.instancecreatetime
              Type: string
            - Name: snapshot.masterusername
              Type: string
            - Name: snapshot.engineversion
              Type: string  
          Location: !Sub s3://${S3BucketArchive}/formatted/${RdsInsFormtArchGlueTbl}/
          InputFormat: org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat      
          OutputFormat: org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat
          SerdeInfo:
            SerializationLibrary: org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe
            Parameters:
              serialization.format: 1
  GlueTableSnapshotInsightRdsClsFormtArch:
    Type: AWS::Glue::Table
    Properties:
      CatalogId: !Ref AWS::AccountId
      DatabaseName: !Ref GlueDatabaseSnapshotInsight
      TableInput:
        Description: Orphan Snapshot RDS Cluster Snapshot Formatted data Archive Table
        Name: !Ref RdsClsFormtArchGlueTbl
        TableType: EXTERNAL_TABLE
        Parameters:
          CrawlerSchemaSerializerVersion: 1.0
          CrawlerSchemaDeserializerVersion: 1.0
          partition_filtering.enabled	: "true"
          compressionType: none
          classification: parquet
          typeOfData: file
        PartitionKeys:
          - Name: job_run_dt
            Type: string
          - Name: par_account_id
            Type: string
          - Name: par_region
            Type: string   
        StorageDescriptor:
          Columns:
            - Name: aws_account
              Type: string
            - Name: account_name
              Type: string  
            - Name: region
              Type: string
            - Name: ops
              Type: string
            - Name: lambda_output.statuscode
              Type: int
            - Name: par_year
              Type: string
            - Name: par_month
              Type: string
            - Name: par_day
              Type: string
            - Name: par_sf_exc_id
              Type: string
            # - Name: par_region
            #   Type: string  
            - Name: snapshot.dbclustersnapshotidentifier
              Type: string
            - Name: snapshot.dbclusteridentifier
              Type: string
            - Name: snapshot.snapshotcreatetime
              Type: string
            - Name: snapshot.engine
              Type: string
            - Name: snapshot.enginemode
              Type: string
            - Name: snapshot.allocatedstorage
              Type: int
            - Name: snapshot.status
              Type: string
            - Name: snapshot.port
              Type: int
            - Name: snapshot.vpcid
              Type: string
            - Name: snapshot.clustercreatetime
              Type: string
            - Name: volume.masterusername
              Type: string
            - Name: volume.engineversion
              Type: string  
          Location: !Sub s3://${S3BucketArchive}/formatted/${RdsClsFormtArchGlueTbl}/
          InputFormat: org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat      
          OutputFormat: org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat
          SerdeInfo:
            SerializationLibrary: org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe
            Parameters:
              serialization.format: 1
  #Glue Crawlers
  SnapshotInsightRawDataGlueCrawler:
    Type: AWS::Glue::Crawler
    Properties:
      Name: SnapshotInsightRawData
      Description : SnapshotInsight Raw Data Crawler
      Role: !Ref AwsGlueServiceRoleSnapshotInsightGlueCrawler
      DatabaseName: !Ref GlueDatabaseSnapshotInsight
      RecrawlPolicy:
        RecrawlBehavior: CRAWL_EVERYTHING
      SchemaChangePolicy: 
        UpdateBehavior: LOG
        DeleteBehavior: LOG
      Configuration: "{\"Version\":1.0,
                          \"Grouping\":{\"TableLevelConfiguration\":2},
                          \"CreatePartitionIndex\":false,
                          \"CrawlerOutput\":
                                {
                                  \"Partitions\":
                                      {\"AddOrUpdateBehavior\":\"InheritFromTable\"},
                                  \"Tables\":
                                        {\"AddOrUpdateBehavior\":\"MergeNewColumns\"}
                                }
                      }"
      Targets:
        S3Targets:
          - Path: !Sub s3://${S3BucketRaw}/
  SnapshotInsightFormattedDataGlueCrawler:
    Type: AWS::Glue::Crawler
    Properties:
      Name: SnapshotInsightFormattedData
      Description : SnapshotInsight Formatted Data Crawler
      Role: !Ref AwsGlueServiceRoleSnapshotInsightGlueCrawler
      DatabaseName: !Ref GlueDatabaseSnapshotInsight
      RecrawlPolicy:
        RecrawlBehavior: CRAWL_EVERYTHING
      SchemaChangePolicy: 
        UpdateBehavior: LOG
        DeleteBehavior: LOG
      Configuration: "{\"Version\":1.0,
                          \"Grouping\":{\"TableLevelConfiguration\":2},
                          \"CreatePartitionIndex\":true
                      }"
      Targets:
        S3Targets:
          - Path: !Sub s3://${S3BucketFormatted}/
  SnapshotInsightArchiveDataGlueCrawler:
    Type: AWS::Glue::Crawler
    Properties:
      Name: SnapshotInsightArchiveData
      Description : SnapshotInsight Archive Data Crawler
      Role: !Ref AwsGlueServiceRoleSnapshotInsightGlueCrawler
      DatabaseName: !Ref GlueDatabaseSnapshotInsight
      RecrawlPolicy:
        RecrawlBehavior: CRAWL_EVERYTHING
      SchemaChangePolicy: 
        UpdateBehavior: LOG
        DeleteBehavior: LOG
      Configuration: "{\"Version\":1.0,
                          \"Grouping\":{\"TableLevelConfiguration\":3},
                          \"CreatePartitionIndex\":true
                      }"
      Targets:
        S3Targets:
          - Path: !Sub s3://${S3BucketArchive}/
            Exclusions:
              - 'raw/**'
  #Glue ETL Jobs
  SnapshotInsightRdsInsJsonToParquetGlueJob:
    Type: AWS::Glue::Job
    Properties:
      Name: SnapshotInsightRdsInsJsonToParquet
      Description: Aws Orphan Snapshot RDS Instance Snapshot Json To Parquet
      Role: !Ref AwsGlueServiceRoleSnapshotInsightGlueCrawler
      Command:
        Name: glueetl
        PythonVersion: 3
        ScriptLocation: !Sub s3://${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}/objects/${TemplateVersion}/glue/etl_jobs/SnapshotInsightRdsInsJsonToParquet.py
      GlueVersion: 4.0
      ExecutionProperty:
        MaxConcurrentRuns: 1
      DefaultArguments:
        --glue_database: !Ref GlueDatabaseSnapshotInsight
        --source_table_name: !Ref GlueTableSnapshotInsightRdsInsRaw
        --target_s3_path: !Sub 's3://${S3BucketFormatted}/${GlueTableSnapshotInsightRdsInsFormatted}/'
        --job-bookmark-option: job-bookmark-disable
        --enable-metrics: ''
        --enable-auto-scaling : true
        --enable-glue-datacatalog : true
        --enable-job-insights : false
        --enable-observability-metrics: true
        --enable-continuous-cloudwatch-log : true
        --enable-spark-ui : true
        --spark-event-logs-path : !Sub s3://${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}/sparkHistoryLogs/
        --TempDir : !Sub s3://${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}/temporary/
        --extra-py-files : 's3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_common.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_flatten.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_explode.py'
  SnapshotInsightRdsClsJsonToParquetGlueJob:
    Type: AWS::Glue::Job
    Properties:
      Name: SnapshotInsightRdsClsJsonToParquet
      Description: Aws Orphan Snapshot RDS Cluster Snapshot Json To Parquet
      Role: !Ref AwsGlueServiceRoleSnapshotInsightGlueCrawler
      Command:
        Name: glueetl
        PythonVersion: 3
        ScriptLocation: !Sub s3://${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}/objects/${TemplateVersion}/glue/etl_jobs/SnapshotInsightRdsClsJsonToParquet.py
      GlueVersion: 4.0
      ExecutionProperty:
        MaxConcurrentRuns: 1
      DefaultArguments:
        --glue_database: !Ref GlueDatabaseSnapshotInsight
        --source_table_name: !Ref GlueTableSnapshotInsightRdsClsRaw
        --target_s3_path: !Sub 's3://${S3BucketFormatted}/${GlueTableSnapshotInsightRdsClsFormatted}/'
        --job-bookmark-option: job-bookmark-disable
        --enable-metrics: ''
        --enable-auto-scaling : true
        --enable-glue-datacatalog : true
        --enable-job-insights : false
        --enable-observability-metrics: true
        --enable-continuous-cloudwatch-log : true
        --enable-spark-ui : true
        --spark-event-logs-path : !Sub s3://${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}/sparkHistoryLogs/
        --TempDir : !Sub s3://${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}/temporary/
        --extra-py-files : 's3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_common.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_flatten.py,s3://aws-glue-studio-transforms-510798373988-prod-us-east-1/gs_explode.py'
  #Lambda
  SnapshotInsightLambda:
    Type: 'AWS::Lambda::Function'
    Condition: isCurrentAccountDeployment
    Properties:
      Description: Lambda Function to retrieve Orphan Snapshots
      FunctionName: Snapshot-Insight
      Handler: osnap.lambda_handler
      MemorySize: 8846
      Architectures:
        - arm64
      EphemeralStorage:
        Size: 512
      Runtime: python3.12
      Role: !GetAtt SnapshotInsightLambdaRole.Arn
      Timeout: 900
      PackageType: Zip
      Environment:
        Variables:
          LOG_GROUP: /aws/lambda/Snapshot-Insight
          RDS_INS_OPS: rds_ins
          RDS_CLS_OPS: rds_cls
          SKIP_OPS: skip
          EXCLUDED_ACCOUNTS: !GetAtt SnapshotInsightExcludedAccounts.Name
      Code:
        S3Bucket: !Sub ${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}
        S3Key: !Sub objects/${TemplateVersion}/lambda/zip/Snapshot-Insight.zip
  SnapshotInsightS3ObjectArchive:
    Type: 'AWS::Lambda::Function'
    Properties:
      Description: Lambda Function to archive Orphan Snapshots Old Data
      FunctionName: Snapshot-Insight-S3Object-Archive
      Handler: lambda_function.lambda_handler
      MemorySize: 1024
      Architectures:
        - arm64
      EphemeralStorage:
        Size: 512
      Runtime: python3.12
      Role: !GetAtt SnapshotInsightS3ObjectArchiveLambdaRole.Arn
      Timeout: 900
      PackageType: Zip
      Environment:
        Variables:
          LOG_GROUP: /aws/lambda/Snapshot-Insight-S3Object-Archive
          RDS_INS_OPS: rds_ins
          RDS_CLS_OPS: rds_cls
          FILE_ARCHIVE: archive
          FILE_FORMATTED: formatted
          FILE_RAW: raw
      Code:
        S3Bucket: !Sub '${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}'
        S3Key: !Sub objects/${TemplateVersion}/lambda/zip/Snapshot-Insight-S3Object-Archive.zip
  SnapshotInsightUtilLambda:
    Type: 'AWS::Lambda::Function'
    Properties:
      Description: Lambda Function to update S3 Raw Data Bucket policy for Cross Account upload
      FunctionName: Snapshot-Insight-Util
      Handler: lambda_function.lambda_handler
      MemorySize: 1024
      Architectures:
        - arm64
      EphemeralStorage:
        Size: 512
      Runtime: python3.12
      Role: !GetAtt SnapshotInsightUtilLambdaRole.Arn
      Timeout: 900
      PackageType: Zip
      Environment:
        Variables:
          LOG_GROUP: /aws/lambda/Snapshot-Insight-Util
          RoleName: SnapshotInsightLambdaRole
      Code:
        S3Bucket: !Sub '${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}'
        S3Key: !Sub objects/${TemplateVersion}/lambda/zip/Snapshot-Insight-Util.zip 
  #Step Functions
  StepFunctionsSnapshotInsight:
    Type: AWS::StepFunctions::StateMachine
    Properties:
      StateMachineName: !Sub StepFunctions-${AWS::StackName}
      StateMachineType: STANDARD
      LoggingConfiguration:
        Destinations:
          - CloudWatchLogsLogGroup:
              LogGroupArn: !GetAtt StepFunctionsSnapshotInsightLogGroup.Arn
        IncludeExecutionData: true
        Level: ALL
      RoleArn: !GetAtt StepFunctionsSnapshotInsightRole.Arn
      DefinitionS3Location: 
        Bucket: !Sub ${SourceCodeBucketPrefix}-${AWS::AccountId}-${AWS::Region}
        Key: !Sub objects/${TemplateVersion}/stepfunction/StepFunctions-Snapshot-Insight/StepFunctions-Snapshot-Insight.json
      DefinitionSubstitutions:
        SnapshotInsightS3ObjectArchive: !Sub '${SnapshotInsightS3ObjectArchive.Arn}:$LATEST'
        SnapshotInsightUtilLambda: !Sub '${SnapshotInsightUtilLambda.Arn}:$LATEST' 
        RawDataS3Bucket : !Ref S3BucketRaw
        FormattedDataS3Bucket : !Ref S3BucketFormatted
        ArchiveDataS3Bucket : !Ref S3BucketArchive
        ManagementAcntId: !Ref ManagementAccountId
        CurrentAccount : !Sub ${AWS::AccountId}
        CurrentRegion : !Sub ${AWS::Region}
        RawDataCrawler: !Ref SnapshotInsightRawDataGlueCrawler
        FormattedDataCrawler: !Ref SnapshotInsightFormattedDataGlueCrawler
        FrmtArchDataCrawler: !Ref SnapshotInsightArchiveDataGlueCrawler
        RdsInsEtlJobName: !Ref SnapshotInsightRdsInsJsonToParquetGlueJob
        RdsClsEtlJobName: !Ref SnapshotInsightRdsClsJsonToParquetGlueJob
      TracingConfiguration:
        Enabled: true
  StepFunctionsSnapshotInsightLogGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: !Sub /aws/vendedlogs/states/StepFunctions-${AWS::StackName}-Logs
      RetentionInDays: 30
  #Event-Bridge Schedule
  SnapshotInsightEvntBridgeSchedule:
    Type: AWS::Scheduler::Schedule
    Properties:
      Name: Snapshot-Insight-EvntBridge-Schedule
      Description: Event Bridge Schedule to invoke Step Function
      GroupName: default
      ScheduleExpression: cron(0 23 ? * SAT *) 
      ScheduleExpressionTimezone: !Ref ScheduleTimeZone
      State: ENABLED
      FlexibleTimeWindow:
        Mode: FLEXIBLE
        MaximumWindowInMinutes: 15
      Target:
        RetryPolicy:
          MaximumEventAgeInSeconds: 86400
          MaximumRetryAttempts: 3
        Arn: !GetAtt StepFunctionsSnapshotInsight.Arn
        RoleArn: !GetAtt SnapshotInsightEvntBridgeScheduleRole.Arn
  #IAM Roles
  StepFunctionsSnapshotInsightRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName: StepFunctions-Snapshot-Insight-role
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - states.amazonaws.com
            Action:
              - sts:AssumeRole
      Path: /
      ManagedPolicyArns:
        - "arn:aws:iam::aws:policy/AWSOrganizationsReadOnlyAccess"
      Policies:
        - PolicyName: Assume_Role
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - sts:AssumeRole
                Resource:
                  - !Sub arn:${AWS::Partition}:iam::*:role/SnapshotInsightLambdaRole
                  - !Sub arn:${AWS::Partition}:iam::${ManagementAccountId}:role/SnapshotInsightMgmntAccountRole
        - PolicyName: CwLogsFullAccess
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - logs:CreateLogDelivery
                  - logs:GetLogDelivery
                  - logs:UpdateLogDelivery
                  - logs:DeleteLogDelivery
                  - logs:ListLogDeliveries
                  - logs:PutResourcePolicy
                  - logs:DescribeResourcePolicies
                  - logs:DescribeLogGroups
                Resource:
                  - '*'
              - Effect: Allow
                Action:
                  - logs:CreateLogGroup
                  - logs:DeleteLogGroup
                  - logs:DeleteLogStream
                  - logs:TagResource
                Resource:
                  - arn:aws:logs:*:*:log-group:/aws/lambda/*Snapshot-Insight-S3Object-Archive:*
                  - arn:aws:logs:*:*:log-group:/aws/lambda/*Snapshot-Insight:*
                  - arn:aws:logs:*:*:log-group:/aws/lambda/*Snapshot-Insight-Util:*
        - PolicyName: GlueExecution
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - glue:StartCrawler
                  - glue:GetCrawler
                  - glue:StartJobRun
                  - glue:GetJobRun
                  - glue:GetJobRuns
                  - glue:BatchStopJobRun
                Resource:
                  - arn:aws:glue:*:*:crawler/*SnapshotInsight*
                  - arn:aws:glue:*:*:job/*SnapshotInsight*
        - PolicyName: LambdaInvoke
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - lambda:InvokeFunction
                  - lambda:InvokeAsync
                  - lambda:ListFunctions
                  - lambda:ListTags
                  - lambda:GetFunction
                  - lambda:GetFunctionConcurrency
                  - lambda:GetFunctionConfiguration
                  - lambda:GetFunctionEventInvokeConfig
                Resource:
                  - !Sub arn:${AWS::Partition}:lambda:*:${AWS::AccountId}:function:Snapshot-Insight-S3Object-Archive:*
                  - !Sub arn:${AWS::Partition}:lambda:*:${AWS::AccountId}:function:Snapshot-Insight-S3Object-Archive
                  - !Sub arn:${AWS::Partition}:lambda:*:${AWS::AccountId}:function:Snapshot-Insight-Util:*
                  - !Sub arn:${AWS::Partition}:lambda:*:${AWS::AccountId}:function:Snapshot-Insight-Util             
        - PolicyName: S3BucketAccess
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - s3:GetObject
                  - s3:PutObject
                  - s3:ListBucket
                  - s3:DeleteObject
                Resource:
                  - arn:aws:s3:::*snapshot-insight*
                  - arn:aws:s3:::*snapshot-insight*/*
        - PolicyName: SsmParameterStoreGetAccess
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - ssm:GetParameters
                  - ssm:GetParameter
                Resource:
                  - !Sub arn:${AWS::Partition}:ssm:*:${AWS::AccountId}:parameter/blog/snapshot-insight/*       
        - PolicyName: StepFunctionExecutionRole
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - states:StartExecution
                Resource:
                  - !Sub arn:${AWS::Partition}:states:${AWS::Region}:${AWS::AccountId}:stateMachine:StepFunctions-${AWS::StackName}
  
  AwsGlueServiceRoleSnapshotInsightGlueCrawler:
    Type: AWS::IAM::Role
    Properties:
      RoleName: AWSGlueServiceRole-Snapshot-Insight-Glue-Crawler
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - glue.amazonaws.com
            Action:
              - sts:AssumeRole
      Path: /
      ManagedPolicyArns:
        - "arn:aws:iam::aws:policy/service-role/AWSGlueServiceRole"
      Policies:
        - PolicyName: S3_Access
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - s3:GetObject
                  - s3:PutObject
                Resource:
                  - arn:aws:s3:::*snapshot-insight-raw*/*
                  - arn:aws:s3:::*snapshot-insight-raw*
                  - arn:aws:s3:::*snapshot-insight-formatted*/*
                  - arn:aws:s3:::*snapshot-insight-formatted*
                  - arn:aws:s3:::*snapshot-insight*/*
                  - arn:aws:s3:::*snapshot-insight*
                  - arn:aws:s3:::*source-code*/*
                  - arn:aws:s3:::*source-code*
  SnapshotInsightLambdaRole:
    Type: AWS::IAM::Role
    Condition : isCurrentAccountDeployment
    Properties:
      RoleName: SnapshotInsightLambdaRole 
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              AWS:
                  - !GetAtt StepFunctionsSnapshotInsightRole.Arn
              Service:
                - lambda.amazonaws.com
            Action:
              - sts:AssumeRole
      Path: /
      ManagedPolicyArns:
        - "arn:aws:iam::aws:policy/AWSOrganizationsReadOnlyAccess"
      Policies:
        - PolicyName: Lambda_Basic_Execution
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action: logs:CreateLogGroup
                Resource: !Sub "arn:${AWS::Partition}:logs:*:${AWS::AccountId}:*"
              - Effect: Allow
                Action:
                  - logs:CreateLogStream
                  - logs:PutLogEvents
                  - logs:DescribeLogStreams
                Resource:
                  - !Sub "arn:${AWS::Partition}:logs:*:${AWS::AccountId}:log-group:/aws/lambda/Snapshot-Insight:*"
                  - !Sub "arn:${AWS::Partition}:logs:*:${AWS::AccountId}:log-group:/aws/lambda/Snapshot-Insight" 
        - PolicyName: Lambda_Invoke
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: "Allow"
                Action:
                  - "lambda:InvokeFunction"
                Resource: 
                  - !Sub "arn:${AWS::Partition}:lambda:*:${AWS::AccountId}:function:Snapshot-Insight:*"
                  - !Sub "arn:${AWS::Partition}:lambda:*:${AWS::AccountId}:function:Snapshot-Insight"
        - PolicyName: RDS_Permission
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: "Allow"
                Action:
                  - "rds:DescribeDBInstances"
                  - "rds:DescribeDBSnapshots"
                  - "rds:DescribeDBClusters"
                  - "rds:DescribeDBClusterSnapshots"
                Resource: 
                  - "arn:aws:rds:*:*:db:*"
                  - "arn:aws:rds:*:*:snapshot:*"
                  - "arn:aws:rds:*:*:cluster:*"
                  - "arn:aws:rds:*:*:cluster-snapshot:*"
        - PolicyName: S3_Permission
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: "Allow"
                Action:
                  - "s3:PutObject"
                  - "s3:GetBucketLocation"
                Resource: 
                  - arn:aws:s3:::*snapshot-insight-raw*/*
                  - arn:aws:s3:::*snapshot-insight-raw*
        - PolicyName: SsmParameterStoreGetAccess
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - ssm:GetParameters
                  - ssm:GetParameter
                Resource:
                  - !Sub arn:${AWS::Partition}:ssm:*:${AWS::AccountId}:parameter/blog/snapshot-insight/*                       
  SnapshotInsightS3ObjectArchiveLambdaRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName: Snapshot-Insight-S3Object-Archive 
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - lambda.amazonaws.com
            Action:
              - sts:AssumeRole
      Path: /
      Policies:
        - PolicyName: LambdaExecutionRole
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - logs:DescribeSnapshots
                Resource:
                  - !Sub 'arn:${AWS::Partition}:logs:${AWS::Region}:${AWS::AccountId}:*'
              - Effect: Allow
                Action:
                  - logs:CreateLogStream
                  - logs:PutLogEvents
                Resource:
                  - !Sub 'arn:${AWS::Partition}:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/Snapshot-Insight-S3Object-Archive:*'
                  - !Sub 'arn:${AWS::Partition}:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/Snapshot-Insight-S3Object-Archive*'    
        - PolicyName: S3BucketAccess
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action: s3:GetObject
                Resource: !Sub "arn:${AWS::Partition}:logs:*:${AWS::AccountId}:*"
              - Effect: Allow
                Action:
                  - s3:GetObject
                  - s3:PutObject
                  - s3:ListBucket
                  - s3:DeleteObject
                Resource:
                  - !Sub "arn:${AWS::Partition}:s3:::*snapshot-insight*"
                  - !Sub "arn:${AWS::Partition}:s3:::*snapshot-insight*/*" 
  SnapshotInsightUtilLambdaRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName: SnapshotInsightUtilLambdaRole
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - lambda.amazonaws.com
            Action:
              - sts:AssumeRole
      Path: /
      Policies:
        - PolicyName: LambdaBasicExecutionRole
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - logs:CreateLogGroup
                Resource:
                  - !Sub 'arn:${AWS::Partition}:logs:${AWS::Region}:${AWS::AccountId}:*'
              - Effect: Allow
                Action:
                  - logs:CreateLogStream
                  - logs:PutLogEvents
                Resource:
                  - !Sub 'arn:${AWS::Partition}:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/Snapshot-Insight-Util:*'
        - PolicyName: S3BucketPolicyUpdate
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - s3:GetBucketPolicy
                  - s3:PutBucketPolicy
                Resource:
                  - !GetAtt S3BucketRaw.Arn        
  SnapshotInsightEvntBridgeScheduleRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName: Snapshot-Insight-EventBridge-Schedule
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
          - Effect: Allow
            Principal:
              Service:
                - scheduler.amazonaws.com
            Action:
              - sts:AssumeRole
            Condition:
              StringEquals:
                aws:SourceAccount: !Sub ${AWS::AccountId}
      Path: /
      Policies:
        - PolicyName: EventBridgeScheduleExecutionPolicy
          PolicyDocument:
            Version: 2012-10-17
            Statement:
              - Effect: Allow
                Action:
                  - states:StartExecution
                Resource: 
                  - !GetAtt StepFunctionsSnapshotInsight.Arn   
  ###################################
  #Quicksight Resources
  ###################################
  #S3 Buckets
  S3BucketAthenaQueryResults:
    Type: AWS::S3::Bucket
    Condition: NeedDashboard
    Properties:
      BucketName: !Sub "aws-athena-query-results-aor-${AWS::AccountId}-${AWS::Region}"
      VersioningConfiguration:
        Status: Enabled
  #Athena
  SnapshotInsightAthenaWorkGroup:
    Type: AWS::Athena::WorkGroup
    Condition: NeedDashboard
    Properties:
      Name: 'AOR'
      Description: 'Used for Snapshot Insight'
      RecursiveDeleteOption: true
      WorkGroupConfiguration:
        EnforceWorkGroupConfiguration: true
        BytesScannedCutoffPerQuery: 1000000000000000
        ResultConfiguration:
          EncryptionConfiguration:
            EncryptionOption: SSE_S3
          OutputLocation: !Sub 's3://${S3BucketAthenaQueryResults}/'
  #DataSource
  DataSourceResourceInsight:
    Type: 'AWS::QuickSight::DataSource'
    Condition: NeedDashboard
    Properties:
      AwsAccountId: !Sub '${AWS::AccountId}'
      DataSourceId: 864174a0-284d-4a07-baa4-b7bab291238b
      DataSourceParameters:
        AthenaParameters:
          WorkGroup: !Ref SnapshotInsightAthenaWorkGroup
      Name: Aws Orphan Resources
      Permissions:
        - Actions:
            - 'quicksight:PassDataSource'
            - 'quicksight:DescribeDataSourcePermissions'
            - 'quicksight:UpdateDataSource'
            - 'quicksight:UpdateDataSourcePermissions'
            - 'quicksight:DescribeDataSource'
            - 'quicksight:DeleteDataSource'
          Principal: !Sub 'arn:${AWS::Partition}:quicksight:${QuicksightIdentityRegion}:${AWS::AccountId}:user/default/${QuicksightUserName}'
      SslProperties:
        DisableSsl: false
      Type: ATHENA
  #Data Set
  DataSetRdsInsView:
    Type: 'AWS::QuickSight::DataSet'
    Condition: NeedDashboard
    Properties:
      AwsAccountId: !Sub '${AWS::AccountId}'
      DataSetId: 7ca43536-f0e5-46fe-9912-8f31ebf8e9b1
      DataSetUsageConfiguration:
        DisableUseAsDirectQuerySource: false
        DisableUseAsImportedSource: false
      ImportMode: SPICE
      LogicalTableMap:
        cf1e9f68-3a22-4aee-9bad-f2bf87e9344c:
          Alias: rds_ins_view
          DataTransforms:
            - CastColumnTypeOperation:
                ColumnName: snapshot_snapshotcreatetime
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - CastColumnTypeOperation:
                ColumnName: snapshot_instancecreatetime
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - TagColumnOperation:
                ColumnName: region
                Tags:
                  - ColumnGeographicRole: STATE
            - TagColumnOperation:
                ColumnName: par_region
                Tags:
                  - ColumnGeographicRole: STATE
            - ProjectOperation:
                ProjectedColumns:
                  - aws_account
                  - account_name
                  - region
                  - ops
                  - lambda_output_statuscode
                  - par_year
                  - par_month
                  - par_day
                  - par_sf_exc_id
                  - snapshot_dbsnapshotidentifier
                  - snapshot_dbinstanceidentifier
                  - snapshot_snapshotcreatetime
                  - snapshot_engine
                  - snapshot_allocatedstorage
                  - snapshot_status
                  - snapshot_port
                  - snapshot_availabilityzone
                  - snapshot_vpcid
                  - snapshot_instancecreatetime
                  - snapshot_masterusername
                  - snapshot_engineversion
                  - par_account_id
                  - par_region
                  - tag_key
                  - tag_value
                  - file_crt_dt
          Source:
            PhysicalTableId: b90593d4-2c0d-4fcb-a6ba-9fb14555e9a9
      Name: rds_ins_view
      Permissions:
        - Actions:
            - 'quicksight:DeleteDataSet'
            - 'quicksight:UpdateDataSetPermissions'
            - 'quicksight:PutDataSetRefreshProperties'
            - 'quicksight:CreateRefreshSchedule'
            - 'quicksight:CancelIngestion'
            - 'quicksight:PassDataSet'
            - 'quicksight:ListRefreshSchedules'
            - 'quicksight:DeleteRefreshSchedule'
            - 'quicksight:UpdateRefreshSchedule'
            - 'quicksight:DescribeDataSetRefreshProperties'
            - 'quicksight:DescribeDataSet'
            - 'quicksight:CreateIngestion'
            - 'quicksight:DescribeRefreshSchedule'
            - 'quicksight:ListIngestions'
            - 'quicksight:DescribeDataSetPermissions'
            - 'quicksight:UpdateDataSet'
            - 'quicksight:DeleteDataSetRefreshProperties'
            - 'quicksight:DescribeIngestion'
          Principal: !Sub 'arn:${AWS::Partition}:quicksight:${QuicksightIdentityRegion}:${AWS::AccountId}:user/default/${QuicksightUserName}'
      PhysicalTableMap:
        b90593d4-2c0d-4fcb-a6ba-9fb14555e9a9:
          CustomSql:
            Columns:
              - Name: aws_account
                Type: STRING
              - Name: account_name
                Type: STRING
              - Name: region
                Type: STRING
              - Name: ops
                Type: STRING
              - Name: lambda_output_statuscode
                Type: INTEGER
              - Name: par_year
                Type: STRING
              - Name: par_month
                Type: STRING
              - Name: par_day
                Type: STRING
              - Name: par_sf_exc_id
                Type: STRING
              - Name: snapshot_dbsnapshotidentifier
                Type: STRING
              - Name: snapshot_dbinstanceidentifier
                Type: STRING
              - Name: snapshot_snapshotcreatetime
                Type: STRING
              - Name: snapshot_engine
                Type: STRING
              - Name: snapshot_allocatedstorage
                Type: INTEGER
              - Name: snapshot_status
                Type: STRING
              - Name: snapshot_port
                Type: INTEGER
              - Name: snapshot_availabilityzone
                Type: STRING
              - Name: snapshot_vpcid
                Type: STRING
              - Name: snapshot_instancecreatetime
                Type: STRING
              - Name: snapshot_masterusername
                Type: STRING
              - Name: snapshot_engineversion
                Type: STRING
              - Name: par_account_id
                Type: STRING
              - Name: par_region
                Type: STRING
              - Name: tag_key
                Type: STRING
              - Name: tag_value
                Type: STRING
              - Name: file_crt_dt
                Type: STRING
            DataSourceArn: !GetAtt 
              - DataSourceResourceInsight
              - Arn
            Name: rds_ins_view
            SqlQuery: !Sub "SELECT \n    \"aws_account\" aws_account,\n\t\"account_name\" account_name,\n\t\"region\" region,\n\t\"ops\" ops,\n\t\"lambda_output.statuscode\" lambda_output_statuscode,\n\t\"par_year\" par_year,\n\t\"par_month\" par_month,\n\t\"par_day\" par_day,\n\t\"par_sf_exc_id\" par_sf_exc_id,\n\t\"snapshot.dbsnapshotidentifier\" snapshot_dbsnapshotidentifier,\n\t\"snapshot.dbinstanceidentifier\" snapshot_dbinstanceidentifier,\n\tdate_format(CAST(substring(\"snapshot.snapshotcreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_snapshotcreatetime,\n\t\"snapshot.engine\" snapshot_engine,\n\t\"snapshot.allocatedstorage\" snapshot_allocatedstorage,\n\t\"snapshot.status\" snapshot_status,\n\t\"snapshot.port\" snapshot_port,\n\t\"snapshot.availabilityzone\" snapshot_availabilityzone,\n\t\"snapshot.vpcid\" snapshot_vpcid,\n\tdate_format(CAST(substring(\"snapshot.instancecreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' ) snapshot_instancecreatetime,\n\t\"snapshot.masterusername\" snapshot_masterusername,\n\t\"snapshot.engineversion\" snapshot_engineversion,\n\t\"par_account_id\" par_account_id,\n\t\"par_region\" par_region,\n\t'tag_key' tag_key,\n\t'tag_value' tag_value,\n\tdate_format(date_parse(concat(\"par_day\",'-',\"par_month\",'-',\"par_year\"),'%d-%m-%Y'),'%d-%M-%Y' ) file_crt_dt\nFROM ${GlueDatabaseName}.rds_ins\nWHERE 1 = 1"
  DataSetRdsClsView:
    Type: 'AWS::QuickSight::DataSet'
    Condition: NeedDashboard
    Properties:
      AwsAccountId: !Sub '${AWS::AccountId}'
      DataSetId: 8ac616c6-c83f-4ab7-813a-9a1334d5c91b
      DataSetUsageConfiguration:
        DisableUseAsDirectQuerySource: false
        DisableUseAsImportedSource: false
      ImportMode: SPICE
      LogicalTableMap:
        fd10ea9f-db2b-4057-82f5-09d06cb6fe50:
          Alias: rds_cls_view
          DataTransforms:
            - CastColumnTypeOperation:
                ColumnName: snapshot_snapshotcreatetime
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - CastColumnTypeOperation:
                ColumnName: snapshot_clustercreatetime
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - CastColumnTypeOperation:
                ColumnName: file_crt_dt
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - TagColumnOperation:
                ColumnName: region
                Tags:
                  - ColumnGeographicRole: STATE
            - TagColumnOperation:
                ColumnName: par_region
                Tags:
                  - ColumnGeographicRole: STATE
            - ProjectOperation:
                ProjectedColumns:
                  - aws_account
                  - account_name
                  - region
                  - ops
                  - lambda_output_statuscode
                  - par_year
                  - par_month
                  - par_day
                  - par_sf_exc_id
                  - snapshot_dbclustersnapshotidentifier
                  - snapshot_dbclusteridentifier
                  - snapshot_snapshotcreatetime
                  - snapshot_engine
                  - snapshot_enginemode
                  - snapshot_allocatedstorage
                  - snapshot_status
                  - snapshot_port
                  - snapshot_vpcid
                  - snapshot_clustercreatetime
                  - volume_masterusername
                  - volume_engineversion
                  - par_account_id
                  - par_region
                  - tag_key
                  - tag_value
                  - file_crt_dt
          Source:
            PhysicalTableId: 6196dab9-e285-4494-bfc3-b54f23d3679c
      Name: rds_cls_view
      Permissions:
        - Actions:
            - 'quicksight:DeleteDataSet'
            - 'quicksight:UpdateDataSetPermissions'
            - 'quicksight:PutDataSetRefreshProperties'
            - 'quicksight:CreateRefreshSchedule'
            - 'quicksight:CancelIngestion'
            - 'quicksight:UpdateRefreshSchedule'
            - 'quicksight:DeleteRefreshSchedule'
            - 'quicksight:ListRefreshSchedules'
            - 'quicksight:PassDataSet'
            - 'quicksight:DescribeDataSetRefreshProperties'
            - 'quicksight:DescribeDataSet'
            - 'quicksight:CreateIngestion'
            - 'quicksight:DescribeRefreshSchedule'
            - 'quicksight:ListIngestions'
            - 'quicksight:UpdateDataSet'
            - 'quicksight:DescribeDataSetPermissions'
            - 'quicksight:DeleteDataSetRefreshProperties'
            - 'quicksight:DescribeIngestion'
          Principal: !Sub 'arn:${AWS::Partition}:quicksight:${QuicksightIdentityRegion}:${AWS::AccountId}:user/default/${QuicksightUserName}'
      PhysicalTableMap:
        6196dab9-e285-4494-bfc3-b54f23d3679c:
          CustomSql:
            Columns:
              - Name: aws_account
                Type: STRING
              - Name: account_name
                Type: STRING
              - Name: region
                Type: STRING
              - Name: ops
                Type: STRING
              - Name: lambda_output_statuscode
                Type: INTEGER
              - Name: par_year
                Type: STRING
              - Name: par_month
                Type: STRING
              - Name: par_day
                Type: STRING
              - Name: par_sf_exc_id
                Type: STRING
              - Name: snapshot_dbclustersnapshotidentifier
                Type: STRING
              - Name: snapshot_dbclusteridentifier
                Type: STRING
              - Name: snapshot_snapshotcreatetime
                Type: STRING
              - Name: snapshot_engine
                Type: STRING
              - Name: snapshot_enginemode
                Type: STRING
              - Name: snapshot_allocatedstorage
                Type: INTEGER
              - Name: snapshot_status
                Type: STRING
              - Name: snapshot_port
                Type: INTEGER
              - Name: snapshot_vpcid
                Type: STRING
              - Name: snapshot_clustercreatetime
                Type: STRING
              - Name: volume_masterusername
                Type: STRING
              - Name: volume_engineversion
                Type: STRING
              - Name: par_account_id
                Type: STRING
              - Name: par_region
                Type: STRING
              - Name: tag_key
                Type: STRING
              - Name: tag_value
                Type: STRING
              - Name: file_crt_dt
                Type: STRING
            DataSourceArn: !GetAtt 
              - DataSourceResourceInsight
              - Arn
            Name: rds_cls_view
            SqlQuery: !Sub "SELECT \n    \"aws_account\" aws_account,\n\t\"account_name\" account_name,\n\t\"region\" region,\n\t\"ops\" ops,\n\t\"lambda_output.statuscode\" lambda_output_statuscode,\n\t\"par_year\" par_year,\n\t\"par_month\" par_month,\n\t\"par_day\" par_day,\n\t\"par_sf_exc_id\" par_sf_exc_id,\n\t\"snapshot.dbclustersnapshotidentifier\" snapshot_dbclustersnapshotidentifier,\n\t\"snapshot.dbclusteridentifier\" snapshot_dbclusteridentifier,\n\tdate_format(CAST(substring(\"snapshot.snapshotcreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_snapshotcreatetime,\n\t\"snapshot.engine\" snapshot_engine,\n\t\"snapshot.enginemode\" snapshot_enginemode,\n\t\"snapshot.allocatedstorage\" snapshot_allocatedstorage,\n\t\"snapshot.status\" snapshot_status,\n\t\"snapshot.port\" snapshot_port,\n\t\"snapshot.vpcid\" snapshot_vpcid,\n\tdate_format(CAST(substring(\"snapshot.clustercreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_clustercreatetime,\n\t\"volume.masterusername\" volume_masterusername,\n\t\"volume.engineversion\" volume_engineversion,\n\t\"par_account_id\" par_account_id,\n\t\"par_region\" par_region,\n\t'tag_key' tag_key,\n\t'tag_value' tag_value,\n\tdate_format(date_parse(concat(\"par_day\",'-',\"par_month\",'-',\"par_year\"),'%d-%m-%Y'),'%d-%M-%Y' ) file_crt_dt\nFROM ${GlueDatabaseName}.rds_cls\nWHERE 1=1"
  DataSetRdsInsTrend:
    Type: 'AWS::QuickSight::DataSet'
    Condition: NeedDashboard
    Properties:
      AwsAccountId: !Sub '${AWS::AccountId}'
      DataSetId: 34e27c12-71ae-409b-934d-34840a290a94
      DataSetUsageConfiguration:
        DisableUseAsDirectQuerySource: false
        DisableUseAsImportedSource: false
      ImportMode: SPICE
      LogicalTableMap:
        39ba9443-440d-432b-878f-eab88bf70a4d:
          Alias: rds_ins_trend
          DataTransforms:
            - CastColumnTypeOperation:
                ColumnName: snapshot_snapshotcreatetime
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - CastColumnTypeOperation:
                ColumnName: snapshot_instancecreatetime
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - CastColumnTypeOperation:
                ColumnName: file_crt_dt
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - TagColumnOperation:
                ColumnName: region
                Tags:
                  - ColumnGeographicRole: STATE
            - TagColumnOperation:
                ColumnName: par_region
                Tags:
                  - ColumnGeographicRole: STATE
            - ProjectOperation:
                ProjectedColumns:
                  - aws_account
                  - account_name
                  - region
                  - ops
                  - lambda_output_statuscode
                  - par_year
                  - par_month
                  - par_day
                  - par_sf_exc_id
                  - snapshot_dbsnapshotidentifier
                  - snapshot_dbinstanceidentifier
                  - snapshot_snapshotcreatetime
                  - snapshot_engine
                  - snapshot_allocatedstorage
                  - snapshot_status
                  - snapshot_port
                  - snapshot_availabilityzone
                  - snapshot_vpcid
                  - snapshot_instancecreatetime
                  - snapshot_masterusername
                  - snapshot_engineversion
                  - par_account_id
                  - par_region
                  - tag_key
                  - tag_value
                  - file_crt_dt
                  - data_type
          Source:
            PhysicalTableId: 41eed007-5b2d-475d-b18b-53828f46e254
      Name: rds_ins_trend
      Permissions:
        - Actions:
            - 'quicksight:DeleteDataSet'
            - 'quicksight:UpdateDataSetPermissions'
            - 'quicksight:PutDataSetRefreshProperties'
            - 'quicksight:CreateRefreshSchedule'
            - 'quicksight:CancelIngestion'
            - 'quicksight:PassDataSet'
            - 'quicksight:ListRefreshSchedules'
            - 'quicksight:UpdateRefreshSchedule'
            - 'quicksight:DeleteRefreshSchedule'
            - 'quicksight:DescribeDataSetRefreshProperties'
            - 'quicksight:DescribeDataSet'
            - 'quicksight:CreateIngestion'
            - 'quicksight:DescribeRefreshSchedule'
            - 'quicksight:ListIngestions'
            - 'quicksight:UpdateDataSet'
            - 'quicksight:DescribeDataSetPermissions'
            - 'quicksight:DeleteDataSetRefreshProperties'
            - 'quicksight:DescribeIngestion'
          Principal: !Sub 'arn:${AWS::Partition}:quicksight:${QuicksightIdentityRegion}:${AWS::AccountId}:user/default/${QuicksightUserName}'
      PhysicalTableMap:
        41eed007-5b2d-475d-b18b-53828f46e254:
          CustomSql:
            Columns:
              - Name: aws_account
                Type: STRING
              - Name: account_name
                Type: STRING
              - Name: region
                Type: STRING
              - Name: ops
                Type: STRING
              - Name: lambda_output_statuscode
                Type: INTEGER
              - Name: par_year
                Type: STRING
              - Name: par_month
                Type: STRING
              - Name: par_day
                Type: STRING
              - Name: par_sf_exc_id
                Type: STRING
              - Name: snapshot_dbsnapshotidentifier
                Type: STRING
              - Name: snapshot_dbinstanceidentifier
                Type: STRING
              - Name: snapshot_snapshotcreatetime
                Type: STRING
              - Name: snapshot_engine
                Type: STRING
              - Name: snapshot_allocatedstorage
                Type: INTEGER
              - Name: snapshot_status
                Type: STRING
              - Name: snapshot_port
                Type: INTEGER
              - Name: snapshot_availabilityzone
                Type: STRING
              - Name: snapshot_vpcid
                Type: STRING
              - Name: snapshot_instancecreatetime
                Type: STRING
              - Name: snapshot_masterusername
                Type: STRING
              - Name: snapshot_engineversion
                Type: STRING
              - Name: par_account_id
                Type: STRING
              - Name: par_region
                Type: STRING
              - Name: tag_key
                Type: STRING
              - Name: tag_value
                Type: STRING
              - Name: file_crt_dt
                Type: STRING
              - Name: data_type
                Type: STRING
            DataSourceArn: !GetAtt 
              - DataSourceResourceInsight
              - Arn
            Name: rds_ins_trend
            SqlQuery: !Sub "SELECT \n    \"aws_account\" aws_account,\n\t\"account_name\" account_name,\n\t\"region\" region,\n\t\"ops\" ops,\n\t\"lambda_output.statuscode\" lambda_output_statuscode,\n\t\"par_year\" par_year,\n\t\"par_month\" par_month,\n\t\"par_day\" par_day,\n\t\"par_sf_exc_id\" par_sf_exc_id,\n\t\"snapshot.dbsnapshotidentifier\" snapshot_dbsnapshotidentifier,\n\t\"snapshot.dbinstanceidentifier\" snapshot_dbinstanceidentifier,\n\tdate_format(CAST(substring(\"snapshot.snapshotcreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_snapshotcreatetime,\n\t\"snapshot.engine\" snapshot_engine,\n\t\"snapshot.allocatedstorage\" snapshot_allocatedstorage,\n\t\"snapshot.status\" snapshot_status,\n\t\"snapshot.port\" snapshot_port,\n\t\"snapshot.availabilityzone\" snapshot_availabilityzone,\n\t\"snapshot.vpcid\" snapshot_vpcid,\n\tdate_format(CAST(substring(\"snapshot.instancecreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_instancecreatetime,\n\t\"snapshot.masterusername\" snapshot_masterusername,\n\t\"snapshot.engineversion\" snapshot_engineversion,\n\t\"par_account_id\" par_account_id,\n\t\"par_region\" par_region,\n\t'tag_key' tag_key,\n\t'tag_value' tag_value,\n\tdate_format(date_parse(concat(\"par_day\",'-',\"par_month\",'-',\"par_year\"),'%d-%m-%Y'),'%d-%M-%Y' ) file_crt_dt,\n\t'archive' data_type\nFROM ${GlueDatabaseName}.rds_ins_formatted_archive\nWHERE 1 = 1\nand CAST(\"concat\"(\"par_year\", '-', \"par_month\", '-',\"par_day\") AS date)  >= (\"date_trunc\"('month', current_date) - INTERVAL  '13' MONTH)\nAND CAST(\"concat\"(\"par_year\", '-', \"par_month\", '-',\"par_day\") AS date) <= (\"date_trunc\"('month', current_date) + INTERVAL  '0' MONTH) -- exclude current month\nunion all\nSELECT \n    \"aws_account\" aws_account,\n\t\"account_name\" account_name,\n\t\"region\" region,\n\t\"ops\" ops,\n\t\"lambda_output.statuscode\" lambda_output_statuscode,\n\t\"par_year\" par_year,\n\t\"par_month\" par_month,\n\t\"par_day\" par_day,\n\t\"par_sf_exc_id\" par_sf_exc_id,\n\t\"snapshot.dbsnapshotidentifier\" snapshot_dbsnapshotidentifier,\n\t\"snapshot.dbinstanceidentifier\" snapshot_dbinstanceidentifier,\n\tdate_format(CAST(substring(\"snapshot.snapshotcreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_snapshotcreatetime,\n\t\"snapshot.engine\" snapshot_engine,\n\t\"snapshot.allocatedstorage\" snapshot_allocatedstorage,\n\t\"snapshot.status\" snapshot_status,\n\t\"snapshot.port\" snapshot_port,\n\t\"snapshot.availabilityzone\" snapshot_availabilityzone,\n\t\"snapshot.vpcid\" snapshot_vpcid,\n\tdate_format(CAST(substring(\"snapshot.instancecreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_instancecreatetime,\n\t\"snapshot.masterusername\" snapshot_masterusername,\n\t\"snapshot.engineversion\" snapshot_engineversion,\n\t\"par_account_id\" par_account_id,\n\t\"par_region\" par_region,\n\t'tag_key' tag_key,\n\t'tag_value' tag_value,\n\tdate_format(date_parse(concat(\"par_day\",'-',\"par_month\",'-',\"par_year\"),'%d-%m-%Y'),'%d-%M-%Y' ) file_crt_dt,\n\t'live' data_type\nFROM ${GlueDatabaseName}.rds_ins\nWHERE 1 = 1"
  DataSetRdsClsTrend:
    Type: 'AWS::QuickSight::DataSet' 
    Condition: NeedDashboard
    Properties:
      AwsAccountId: !Sub '${AWS::AccountId}'
      DataSetId: cc25e5fe-7fc2-4494-b072-506f58a0a04f
      DataSetUsageConfiguration:
        DisableUseAsDirectQuerySource: false
        DisableUseAsImportedSource: false
      ImportMode: SPICE
      LogicalTableMap:
        7b30df56-cd21-40d7-ad99-f08b7456b09e:
          Alias: rds_cls_trend
          DataTransforms:
            - CastColumnTypeOperation:
                ColumnName: snapshot_snapshotcreatetime
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - CastColumnTypeOperation:
                ColumnName: snapshot_clustercreatetime
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - CastColumnTypeOperation:
                ColumnName: file_crt_dt
                Format: dd-MMM-yyyy
                NewColumnType: DATETIME
            - TagColumnOperation:
                ColumnName: region
                Tags:
                  - ColumnGeographicRole: STATE
            - TagColumnOperation:
                ColumnName: par_region
                Tags:
                  - ColumnGeographicRole: STATE
            - ProjectOperation:
                ProjectedColumns:
                  - aws_account
                  - account_name
                  - region
                  - ops
                  - lambda_output_statuscode
                  - par_year
                  - par_month
                  - par_day
                  - par_sf_exc_id
                  - snapshot_dbclustersnapshotidentifier
                  - snapshot_dbclusteridentifier
                  - snapshot_snapshotcreatetime
                  - snapshot_engine
                  - snapshot_enginemode
                  - snapshot_allocatedstorage
                  - snapshot_status
                  - snapshot_port
                  - snapshot_vpcid
                  - snapshot_clustercreatetime
                  - volume_masterusername
                  - volume_engineversion
                  - par_account_id
                  - par_region
                  - tag_key
                  - tag_value
                  - file_crt_dt
                  - data_type
          Source:
            PhysicalTableId: df8aa894-baf0-463d-8e4b-c5d293b4aba1
      Name: rds_cls_trend
      Permissions:
        - Actions:
            - 'quicksight:DeleteDataSet'
            - 'quicksight:UpdateDataSetPermissions'
            - 'quicksight:PutDataSetRefreshProperties'
            - 'quicksight:CreateRefreshSchedule'
            - 'quicksight:CancelIngestion'
            - 'quicksight:UpdateRefreshSchedule'
            - 'quicksight:DeleteRefreshSchedule'
            - 'quicksight:ListRefreshSchedules'
            - 'quicksight:PassDataSet'
            - 'quicksight:DescribeDataSetRefreshProperties'
            - 'quicksight:DescribeDataSet'
            - 'quicksight:CreateIngestion'
            - 'quicksight:DescribeRefreshSchedule'
            - 'quicksight:ListIngestions'
            - 'quicksight:UpdateDataSet'
            - 'quicksight:DescribeDataSetPermissions'
            - 'quicksight:DeleteDataSetRefreshProperties'
            - 'quicksight:DescribeIngestion'
          Principal: !Sub 'arn:${AWS::Partition}:quicksight:${QuicksightIdentityRegion}:${AWS::AccountId}:user/default/${QuicksightUserName}'
      PhysicalTableMap:
        df8aa894-baf0-463d-8e4b-c5d293b4aba1:
          CustomSql:
            Columns:
              - Name: aws_account
                Type: STRING
              - Name: account_name
                Type: STRING
              - Name: region
                Type: STRING
              - Name: ops
                Type: STRING
              - Name: lambda_output_statuscode
                Type: INTEGER
              - Name: par_year
                Type: STRING
              - Name: par_month
                Type: STRING
              - Name: par_day
                Type: STRING
              - Name: par_sf_exc_id
                Type: STRING
              - Name: snapshot_dbclustersnapshotidentifier
                Type: STRING
              - Name: snapshot_dbclusteridentifier
                Type: STRING
              - Name: snapshot_snapshotcreatetime
                Type: STRING
              - Name: snapshot_engine
                Type: STRING
              - Name: snapshot_enginemode
                Type: STRING
              - Name: snapshot_allocatedstorage
                Type: INTEGER
              - Name: snapshot_status
                Type: STRING
              - Name: snapshot_port
                Type: INTEGER
              - Name: snapshot_vpcid
                Type: STRING
              - Name: snapshot_clustercreatetime
                Type: STRING
              - Name: volume_masterusername
                Type: STRING
              - Name: volume_engineversion
                Type: STRING
              - Name: par_account_id
                Type: STRING
              - Name: par_region
                Type: STRING
              - Name: tag_key
                Type: STRING
              - Name: tag_value
                Type: STRING
              - Name: file_crt_dt
                Type: STRING
              - Name: data_type
                Type: STRING
            DataSourceArn: !GetAtt 
              - DataSourceResourceInsight
              - Arn
            Name: rds_cls_trend
            SqlQuery: !Sub "SELECT \n    \"aws_account\" aws_account,\n\t\"account_name\" account_name,\n\t\"region\" region,\n\t\"ops\" ops,\n\t\"lambda_output.statuscode\" lambda_output_statuscode,\n\t\"par_year\" par_year,\n\t\"par_month\" par_month,\n\t\"par_day\" par_day,\n\t\"par_sf_exc_id\" par_sf_exc_id,\n\t\"snapshot.dbclustersnapshotidentifier\" snapshot_dbclustersnapshotidentifier,\n\t\"snapshot.dbclusteridentifier\" snapshot_dbclusteridentifier,\n\tdate_format(CAST(substring(\"snapshot.snapshotcreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_snapshotcreatetime,\n\t\"snapshot.engine\" snapshot_engine,\n\t\"snapshot.enginemode\" snapshot_enginemode,\n\t\"snapshot.allocatedstorage\" snapshot_allocatedstorage,\n\t\"snapshot.status\" snapshot_status,\n\t\"snapshot.port\" snapshot_port,\n\t\"snapshot.vpcid\" snapshot_vpcid,\n\tdate_format(CAST(substring(\"snapshot.clustercreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_clustercreatetime,\n\t\"volume.masterusername\" volume_masterusername,\n\t\"volume.engineversion\" volume_engineversion,\n\t\"par_account_id\" par_account_id,\n\t\"par_region\" par_region,\n\t'tag_key' tag_key,\n\t'tag_value' tag_value,\n\tdate_format(date_parse(concat(\"par_day\",'-',\"par_month\",'-',\"par_year\"),'%d-%m-%Y'),'%d-%M-%Y' ) file_crt_dt,\n\t'archive' data_type\nFROM ${GlueDatabaseName}.rds_cls_formatted_archive\nWHERE 1=1\nAND CAST(\"concat\"(\"par_year\", '-', \"par_month\", '-',\"par_day\") AS date)  >= (\"date_trunc\"('month', current_date) - INTERVAL  '13' MONTH)\nAND CAST(\"concat\"(\"par_year\", '-', \"par_month\", '-',\"par_day\") AS date) <= (\"date_trunc\"('month', current_date) + INTERVAL  '0' MONTH) -- exclude current month\nunion all\nSELECT \n    \"aws_account\" aws_account,\n\t\"account_name\" account_name,\n\t\"region\" region,\n\t\"ops\" ops,\n\t\"lambda_output.statuscode\" lambda_output_statuscode,\n\t\"par_year\" par_year,\n\t\"par_month\" par_month,\n\t\"par_day\" par_day,\n\t\"par_sf_exc_id\" par_sf_exc_id,\n\t\"snapshot.dbclustersnapshotidentifier\" snapshot_dbclustersnapshotidentifier,\n\t\"snapshot.dbclusteridentifier\" snapshot_dbclusteridentifier,\n\tdate_format(CAST(substring(\"snapshot.snapshotcreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_snapshotcreatetime,\n\t\"snapshot.engine\" snapshot_engine,\n\t\"snapshot.enginemode\" snapshot_enginemode,\n\t\"snapshot.allocatedstorage\" snapshot_allocatedstorage,\n\t\"snapshot.status\" snapshot_status,\n\t\"snapshot.port\" snapshot_port,\n\t\"snapshot.vpcid\" snapshot_vpcid,\n\tdate_format(CAST(substring(\"snapshot.clustercreatetime\",1,10) AS TIMESTAMP),'%d-%M-%Y' )  snapshot_clustercreatetime,\n\t\"volume.masterusername\" volume_masterusername,\n\t\"volume.engineversion\" volume_engineversion,\n\t\"par_account_id\" par_account_id,\n\t\"par_region\" par_region,\n\t'tag_key' tag_key,\n\t'tag_value' tag_value,\n\tdate_format(date_parse(concat(\"par_day\",'-',\"par_month\",'-',\"par_year\"),'%d-%m-%Y'),'%d-%M-%Y' ) file_crt_dt,\n\t'live' data_type\nFROM ${GlueDatabaseName}.rds_cls\nWHERE 1=1"
     
  #Dashboard
  DashboardResourcesInsight:
    Type: 'AWS::QuickSight::Dashboard'
    Condition: NeedDashboard
    Properties:
      AwsAccountId: !Sub '${AWS::AccountId}'
      DashboardId: beb20665-db4e-4a39-b684-a8a7761bc008
      DashboardPublishOptions:
        AdHocFilteringOption:
          AvailabilityStatus: DISABLED
        DataPointDrillUpDownOption:
          AvailabilityStatus: ENABLED
        DataPointMenuLabelOption:
          AvailabilityStatus: ENABLED
        DataPointTooltipOption:
          AvailabilityStatus: ENABLED
        ExportToCSVOption:
          AvailabilityStatus: ENABLED
        ExportWithHiddenFieldsOption:
          AvailabilityStatus: DISABLED
        SheetControlsOption:
          VisibilityState: COLLAPSED
        SheetLayoutElementMaximizationOption:
          AvailabilityStatus: ENABLED
        VisualAxisSortOption:
          AvailabilityStatus: ENABLED
        VisualMenuOption:
          AvailabilityStatus: ENABLED
      Definition:
        AnalysisDefaults:
          DefaultNewSheetConfiguration:
            InteractiveLayoutConfiguration:
              Grid:
                CanvasSizeOptions:
                  ScreenCanvasSizeOptions:
                    OptimizedViewPortWidth: 1600px
                    ResizeOption: FIXED
            SheetContentType: INTERACTIVE
        CalculatedFields:
          - DataSetIdentifier: rds_cls_trend
            Expression: |2-
                 ifelse(
                 ${Periodstarting}='Daily',truncDate("DD",{file_crt_dt}),
                 ${Periodstarting}='Monthly',truncDate("MM",{file_crt_dt}),
                 ${Periodstarting}='Quarterly',truncDate("Q",{file_crt_dt}),
                 truncDate("YYYY",{file_crt_dt})
                 )
            Name: rds_cls_trend_period
          - DataSetIdentifier: rds_ins_trend
            Expression: |2-
                 ifelse(
                 ${Periodstarting}='Daily',truncDate("DD",{file_crt_dt}),
                 ${Periodstarting}='Monthly',truncDate("MM",{file_crt_dt}),
                 ${Periodstarting}='Quarterly',truncDate("Q",{file_crt_dt}),
                 truncDate("YYYY",{file_crt_dt})
                 )
            Name: rds_ins_trend_period
        DataSetIdentifierDeclarations:
          - DataSetArn: !GetAtt 
              - DataSetRdsInsTrend
              - Arn
            Identifier: rds_ins_trend
          - DataSetArn: !GetAtt 
              - DataSetRdsClsView
              - Arn
            Identifier: rds_cls_view
          - DataSetArn: !GetAtt 
              - DataSetRdsInsView
              - Arn
            Identifier: rds_ins_view
          - DataSetArn: !GetAtt 
              - DataSetRdsClsTrend
              - Arn
            Identifier: rds_cls_trend
        FilterGroups:
          - CrossDataset: ALL_DATASETS
            FilterGroupId: bdf589e9-160d-491a-8e8e-868e2d705038
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: account_name
                    DataSetIdentifier: rds_ins_trend
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: dcda2116-ca2c-4253-9285-88887d515c17
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: ALL_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_a0917b74-2677-4361-871b-9ce2432acad1
            Status: ENABLED
          - CrossDataset: ALL_DATASETS
            FilterGroupId: e046436f-598b-4003-bc05-7aa4960cabcf
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: region
                    DataSetIdentifier: rds_ins_trend
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: e11aca70-6b61-49f5-8a83-118659a4e41e
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: ALL_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_a0917b74-2677-4361-871b-9ce2432acad1
            Status: ENABLED
          - CrossDataset: ALL_DATASETS
            FilterGroupId: 14aed957-81be-4867-b216-cee6d5e38c24
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: snapshot_dbsnapshotidentifier
                    DataSetIdentifier: rds_ins_view
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: a17b3abd-24e7-4917-b223-aa04a518ddbd
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_a0917b74-2677-4361-871b-9ce2432acad1
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_0c2596db-18a1-4a0d-a6ae-dd1026009096
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_589cd311-5147-4c86-b78e-57145d94e401
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_78baa579-f56d-45ba-8447-13adeae0f175
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_6efe3eb4-6723-437a-923a-9ae01f2cf7b6
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_90337c12-10ec-43c4-8e4f-896d8725970a
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_98f2dc05-ac04-48d2-bf21-03ccbc21aee9
            Status: ENABLED
          - CrossDataset: ALL_DATASETS
            FilterGroupId: 8a6e464f-5add-44c1-afe5-940aa5395a91
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: snapshot_dbinstanceidentifier
                    DataSetIdentifier: rds_ins_view
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: f954fa53-d547-4ffe-a7a3-d6a5b8b05707
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_a0917b74-2677-4361-871b-9ce2432acad1
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_0c2596db-18a1-4a0d-a6ae-dd1026009096
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_589cd311-5147-4c86-b78e-57145d94e401
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_78baa579-f56d-45ba-8447-13adeae0f175
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_6efe3eb4-6723-437a-923a-9ae01f2cf7b6
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_90337c12-10ec-43c4-8e4f-896d8725970a
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_98f2dc05-ac04-48d2-bf21-03ccbc21aee9
            Status: ENABLED
          - CrossDataset: ALL_DATASETS
            FilterGroupId: 3d29b385-c1dc-4f1f-bbda-80930ada6415
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: snapshot_engine
                    DataSetIdentifier: rds_ins_view
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: b631cd50-a3eb-43f7-a19d-89778fe8db64
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_a0917b74-2677-4361-871b-9ce2432acad1
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_0c2596db-18a1-4a0d-a6ae-dd1026009096
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_589cd311-5147-4c86-b78e-57145d94e401
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_78baa579-f56d-45ba-8447-13adeae0f175
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_6efe3eb4-6723-437a-923a-9ae01f2cf7b6
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_90337c12-10ec-43c4-8e4f-896d8725970a
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_98f2dc05-ac04-48d2-bf21-03ccbc21aee9
            Status: ENABLED
          - CrossDataset: ALL_DATASETS
            FilterGroupId: 353ecab2-2c6b-4637-8ab5-64a313daf9b0
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: snapshot_engineversion
                    DataSetIdentifier: rds_ins_view
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: ef0e1ff8-dc89-4539-9abd-1f8318f2a14d
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_a0917b74-2677-4361-871b-9ce2432acad1
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_0c2596db-18a1-4a0d-a6ae-dd1026009096
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_589cd311-5147-4c86-b78e-57145d94e401
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_78baa579-f56d-45ba-8447-13adeae0f175
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_6efe3eb4-6723-437a-923a-9ae01f2cf7b6
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_90337c12-10ec-43c4-8e4f-896d8725970a
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_98f2dc05-ac04-48d2-bf21-03ccbc21aee9
            Status: ENABLED
          - CrossDataset: ALL_DATASETS
            FilterGroupId: a72303d4-3b09-48e3-9411-b9230dd19889
            Filters:
              - RelativeDatesFilter:
                  AnchorDateConfiguration:
                    AnchorOption: NOW
                  Column:
                    ColumnName: snapshot_instancecreatetime
                    DataSetIdentifier: rds_ins_view
                  FilterId: 1c5205bb-eb10-486a-9c21-0347b5bc2afc
                  MinimumGranularity: DAY
                  NullOption: NON_NULLS_ONLY
                  RelativeDateType: LAST
                  RelativeDateValue: 2
                  TimeGranularity: YEAR
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_a0917b74-2677-4361-871b-9ce2432acad1
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_0c2596db-18a1-4a0d-a6ae-dd1026009096
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_589cd311-5147-4c86-b78e-57145d94e401
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_78baa579-f56d-45ba-8447-13adeae0f175
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_6efe3eb4-6723-437a-923a-9ae01f2cf7b6
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_90337c12-10ec-43c4-8e4f-896d8725970a
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_98f2dc05-ac04-48d2-bf21-03ccbc21aee9
            Status: ENABLED
          - CrossDataset: ALL_DATASETS
            FilterGroupId: e98c4bce-ec78-4a9a-ba2e-b4cc91afc62d
            Filters:
              - RelativeDatesFilter:
                  AnchorDateConfiguration:
                    AnchorOption: NOW
                  Column:
                    ColumnName: snapshot_snapshotcreatetime
                    DataSetIdentifier: rds_ins_view
                  FilterId: fbe2a985-bc7d-4da2-a389-08f0ac4519cf
                  MinimumGranularity: DAY
                  NullOption: NON_NULLS_ONLY
                  RelativeDateType: LAST
                  RelativeDateValue: 2
                  TimeGranularity: YEAR
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_a0917b74-2677-4361-871b-9ce2432acad1
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_0c2596db-18a1-4a0d-a6ae-dd1026009096
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_589cd311-5147-4c86-b78e-57145d94e401
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_78baa579-f56d-45ba-8447-13adeae0f175
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_6efe3eb4-6723-437a-923a-9ae01f2cf7b6
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_90337c12-10ec-43c4-8e4f-896d8725970a
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_98f2dc05-ac04-48d2-bf21-03ccbc21aee9
            Status: ENABLED
          - CrossDataset: ALL_DATASETS
            FilterGroupId: bce12021-b8d6-47a9-b25a-8733c131983f
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: account_name
                    DataSetIdentifier: rds_cls_trend
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: cfed512d-52f3-4a72-832f-08c7ebec16cd
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: ALL_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_d6580acd-d214-4cb6-b954-062e5ed0bf74
            Status: ENABLED
          - CrossDataset: ALL_DATASETS
            FilterGroupId: 621cc06a-6ffb-4291-b509-cb9416b91145
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: region
                    DataSetIdentifier: rds_cls_trend
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: d60fd5f9-ad99-4950-831b-e8ac61fda633
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: ALL_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_d6580acd-d214-4cb6-b954-062e5ed0bf74
            Status: ENABLED
          - CrossDataset: SINGLE_DATASET
            FilterGroupId: 681c9929-4711-41d1-98b8-f735eb2a4359
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: snapshot_dbclustersnapshotidentifier
                    DataSetIdentifier: rds_cls_view
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: 607c33cc-8f75-49ff-9367-5c4e45c0a219
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_d6580acd-d214-4cb6-b954-062e5ed0bf74
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_8812c860-849d-439c-8803-3ad05e289d22
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_701f6513-8c2e-4618-8d9a-8120213f3f29
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_4e63be09-5b7a-4520-8e04-a112bada576b
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_2f8dcd26-b810-4329-8a15-d40f76ed4cad
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_33bc9e9e-2b16-4df1-b242-3670c833f3e0
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_71f7d041-6f65-46bc-b123-fc67d9a0790a
            Status: ENABLED
          - CrossDataset: SINGLE_DATASET
            FilterGroupId: 94b1b595-5763-45fc-845a-3f243582bee0
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: snapshot_dbclustersnapshotidentifier
                    DataSetIdentifier: rds_cls_view
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: a62273ea-7ea7-452b-bf9d-e0de0f353f45
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_d6580acd-d214-4cb6-b954-062e5ed0bf74
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_8812c860-849d-439c-8803-3ad05e289d22
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_701f6513-8c2e-4618-8d9a-8120213f3f29
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_4e63be09-5b7a-4520-8e04-a112bada576b
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_2f8dcd26-b810-4329-8a15-d40f76ed4cad
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_33bc9e9e-2b16-4df1-b242-3670c833f3e0
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_71f7d041-6f65-46bc-b123-fc67d9a0790a
            Status: ENABLED
          - CrossDataset: SINGLE_DATASET
            FilterGroupId: c2f668ea-d34e-4eb6-8859-44339e0cb570
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: snapshot_engine
                    DataSetIdentifier: rds_cls_view
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: f6705523-302f-49a7-b648-bb7738bf58ea
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_d6580acd-d214-4cb6-b954-062e5ed0bf74
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_8812c860-849d-439c-8803-3ad05e289d22
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_701f6513-8c2e-4618-8d9a-8120213f3f29
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_4e63be09-5b7a-4520-8e04-a112bada576b
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_2f8dcd26-b810-4329-8a15-d40f76ed4cad
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_33bc9e9e-2b16-4df1-b242-3670c833f3e0
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_71f7d041-6f65-46bc-b123-fc67d9a0790a
            Status: ENABLED
          - CrossDataset: SINGLE_DATASET
            FilterGroupId: 7509b30f-8772-4675-93a9-193ac11b114f
            Filters:
              - CategoryFilter:
                  Column:
                    ColumnName: snapshot_enginemode
                    DataSetIdentifier: rds_cls_view
                  Configuration:
                    FilterListConfiguration:
                      MatchOperator: CONTAINS
                      NullOption: NON_NULLS_ONLY
                      SelectAllOptions: FILTER_ALL_VALUES
                  FilterId: e71d6196-cc63-4bfb-a280-2a7009d54134
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_d6580acd-d214-4cb6-b954-062e5ed0bf74
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_8812c860-849d-439c-8803-3ad05e289d22
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_701f6513-8c2e-4618-8d9a-8120213f3f29
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_4e63be09-5b7a-4520-8e04-a112bada576b
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_2f8dcd26-b810-4329-8a15-d40f76ed4cad
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_33bc9e9e-2b16-4df1-b242-3670c833f3e0
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_71f7d041-6f65-46bc-b123-fc67d9a0790a
            Status: ENABLED
          - CrossDataset: SINGLE_DATASET
            FilterGroupId: 112f7ebe-6477-49e6-a1bb-444ec37278e9
            Filters:
              - RelativeDatesFilter:
                  AnchorDateConfiguration:
                    AnchorOption: NOW
                  Column:
                    ColumnName: snapshot_snapshotcreatetime
                    DataSetIdentifier: rds_cls_view
                  FilterId: bd15900c-501c-4e6d-988a-8594514fd224
                  MinimumGranularity: DAY
                  NullOption: NON_NULLS_ONLY
                  RelativeDateType: LAST
                  RelativeDateValue: 2
                  TimeGranularity: YEAR
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_d6580acd-d214-4cb6-b954-062e5ed0bf74
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_8812c860-849d-439c-8803-3ad05e289d22
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_701f6513-8c2e-4618-8d9a-8120213f3f29
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_4e63be09-5b7a-4520-8e04-a112bada576b
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_33bc9e9e-2b16-4df1-b242-3670c833f3e0
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_71f7d041-6f65-46bc-b123-fc67d9a0790a
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_2f8dcd26-b810-4329-8a15-d40f76ed4cad
            Status: ENABLED
          - CrossDataset: SINGLE_DATASET
            FilterGroupId: 0ff80442-0488-4ce4-894b-fe9daab55781
            Filters:
              - RelativeDatesFilter:
                  AnchorDateConfiguration:
                    AnchorOption: NOW
                  Column:
                    ColumnName: snapshot_clustercreatetime
                    DataSetIdentifier: rds_cls_view
                  FilterId: 896ccf81-62dc-4754-9c7b-213102f54a80
                  MinimumGranularity: DAY
                  NullOption: NON_NULLS_ONLY
                  RelativeDateType: LAST
                  RelativeDateValue: 2
                  TimeGranularity: YEAR
            ScopeConfiguration:
              SelectedSheets:
                SheetVisualScopingConfigurations:
                  - Scope: SELECTED_VISUALS
                    SheetId: >-
                      beb20665-db4e-4a39-b684-a8a7761bc008_d6580acd-d214-4cb6-b954-062e5ed0bf74
                    VisualIds:
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_8812c860-849d-439c-8803-3ad05e289d22
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_701f6513-8c2e-4618-8d9a-8120213f3f29
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_4e63be09-5b7a-4520-8e04-a112bada576b
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_2f8dcd26-b810-4329-8a15-d40f76ed4cad
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_33bc9e9e-2b16-4df1-b242-3670c833f3e0
                      - >-
                        beb20665-db4e-4a39-b684-a8a7761bc008_71f7d041-6f65-46bc-b123-fc67d9a0790a
            Status: ENABLED
        Options:
          WeekStart: SUNDAY
        ParameterDeclarations:
          - StringParameterDeclaration:
              DefaultValues:
                StaticValues:
                  - Monthly
              Name: Periodstarting
              ParameterValueType: SINGLE_VALUED
              ValueWhenUnset:
                ValueWhenUnsetOption: 'NULL'
        Sheets:
          - ContentType: INTERACTIVE
            Layouts:
              - Configuration:
                  GridLayout:
                    CanvasSizeOptions:
                      ScreenCanvasSizeOptions:
                        OptimizedViewPortWidth: 1600px
                        ResizeOption: FIXED
                    Elements:
                      - ColumnIndex: 0
                        ColumnSpan: 36
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_0c21469b-6c04-4a81-9a1d-28085fca2783
                        ElementType: VISUAL
                        RowIndex: 0
                        RowSpan: 15
                      - ColumnIndex: 0
                        ColumnSpan: 36
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_d6b0c083-4a17-4b46-93f8-33d94245cec9
                        ElementType: VISUAL
                        RowIndex: 15
                        RowSpan: 7
            Name: Welcome
            SheetId: >-
              beb20665-db4e-4a39-b684-a8a7761bc008_dbfdd18a-ab9c-4199-9dd5-49db448e0bc9
            Visuals:
              - InsightVisual:
                  Actions: []
                  DataSetIdentifier: rds_ins_view
                  InsightConfiguration:
                    Computations: []
                    CustomNarrative:
                      Narrative: |-
                        <narrative>
                          <block align="center"/>
                          <br/>
                          <block align="center"/>
                          <br/>
                          <block align="center">
                            <inline font-size="68.8px">
                              <b>Orphan Resource Insight</b>
                            </inline>
                          </block>
                          <br/>
                          <block align="center"/>
                          <br/>
                          <block align="center"/>
                          <block align="center">
                            <inline font-size="22.4px">
                              <b>- Orphan Snapshot for RDS Instance -</b>
                            </inline>
                          </block>
                          <br/>
                          <block align="center">
                            <inline font-size="22.4px">
                              <b>- Orphan Snapshot for RDS Cluster -</b>
                            </inline>
                          </block>
                          <br/>
                          <block align="center"/>
                          <br/>
                          <block align="center"/>
                          <br/>
                          <block align="center"/>
                          <br/>
                          <block align="center">
                            <inline font-size="22.4px">Invent &amp; Simplify (To be Continued..)</inline>
                          </block>
                          <br/>
                          <block align="right"/>
                          <br/>
                          <block align="right"/>
                          <br/>
                          <block align="right"/>
                          <br/>
                          <block align="right"/>
                          <br/>
                          <block align="right">Built by: Sushovan Basak</block>
                          <br/>
                          <block align="right">Powered by: Amazon QuickSight, Amazon Athena, Amazon S3</block>
                          <br/>
                          <block align="right">
                            If you wish to provide feedback or report an error please email:
                            <inline color="#61d1d6">
                              <a href="mailto:optimize-cloud@amazon.com?subject=AWS%20Orphan%20Resource%20Insight%20Feedback" target="_blank">optimize-cloud@amazon.com</a>
                            </inline>
                          </block>
                          <br/>
                          
                          <br/>
                          <block align="center"/>
                          <br/>
                          <block align="right"/>
                          <br/>
                          <block align="right"/>
                        </narrative>
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_0c21469b-6c04-4a81-9a1d-28085fca2783
              - InsightVisual:
                  Actions: []
                  DataSetIdentifier: rds_ins_view
                  InsightConfiguration:
                    Computations: []
                    CustomNarrative:
                      Narrative: |-
                        <narrative>
                          <inline font-size="54.88px">Notices</inline>
                          <inline font-size="12.8px">
                            <img src="https://d66mvi2kszsvt.cloudfront.net/resources/dashboard-visual-analytics/About/header.png" width="11"/>
                          </inline>
                          <br/>
                          <br/>
                          <inline font-size="22.4px">Customers are responsible for making their own independent assessment of this dashboard and its content.This dashboard and its content: (a) is for informational purposes only, (b) represents current AWS product offerings and practices, which are subject to change without notice, and (c) does not create any commitments or assurances from AWS and its affiliates, suppliers or licensors. AWScontent, products or services are provided as is without warranties, representations, or conditions of any kind, whether express or implied. The responsibilities and liabilities of AWS to its customers are controlled by AWS agreements, and this document is not part of, nor does it modify, any agreement between AWS and its customers.</inline>
                        </narrative>
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_d6b0c083-4a17-4b46-93f8-33d94245cec9
          - ContentType: INTERACTIVE
            FilterControls:
              - RelativeDateTime:
                  DisplayOptions:
                    DateTimeFormat: 'YYYY/MM/DD HH:mm:ss'
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: 42864eee-23bf-4213-a9bb-832dea53ad10
                  SourceFilterId: fbe2a985-bc7d-4da2-a389-08f0ac4519cf
                  Title: Snapshot Create Time
              - RelativeDateTime:
                  DisplayOptions:
                    DateTimeFormat: 'YYYY/MM/DD HH:mm:ss'
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: aa41963c-67ef-4e13-a741-78b03a91c068
                  SourceFilterId: 1c5205bb-eb10-486a-9c21-0347b5bc2afc
                  Title: DB Create Time
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: ed70c8d7-bc80-4e6a-83d8-f8516621b024
                  SourceFilterId: dcda2116-ca2c-4253-9285-88887d515c17
                  Title: Account
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: c9bed69f-f1bb-4cc1-a940-220cf79c8b41
                  SourceFilterId: e11aca70-6b61-49f5-8a83-118659a4e41e
                  Title: Region
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: eaf1fde4-a54a-40ad-b950-79e425b3aa5b
                  SourceFilterId: a17b3abd-24e7-4917-b223-aa04a518ddbd
                  Title: Snapshot Identifier
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: a4d9054d-7925-44e4-bf1e-0f38d25adf11
                  SourceFilterId: f954fa53-d547-4ffe-a7a3-d6a5b8b05707
                  Title: DB Identifier
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: 11aa39aa-8259-4ac6-9c58-fa516f6cdc9c
                  SourceFilterId: b631cd50-a3eb-43f7-a19d-89778fe8db64
                  Title: DB Engine
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: 25393a90-bcc9-4f98-a840-920b702fad81
                  SourceFilterId: ef0e1ff8-dc89-4539-9abd-1f8318f2a14d
                  Title: DB Engine Version
                  Type: MULTI_SELECT
            Layouts:
              - Configuration:
                  GridLayout:
                    CanvasSizeOptions:
                      ScreenCanvasSizeOptions:
                        OptimizedViewPortWidth: 1600px
                        ResizeOption: FIXED
                    Elements:
                      - ColumnIndex: 0
                        ColumnSpan: 18
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_39bded3b-a844-43ba-aa49-ea4019221ade
                        ElementType: VISUAL
                        RowIndex: 0
                        RowSpan: 6
                      - ColumnIndex: 18
                        ColumnSpan: 3
                        ElementId: 910869d4-2749-4848-a10b-dc998ab07688
                        ElementType: PARAMETER_CONTROL
                        RowIndex: 0
                        RowSpan: 6
                      - ColumnIndex: 21
                        ColumnSpan: 6
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_c390aa1b-4e4a-4f50-be02-c9fc85813d46
                        ElementType: VISUAL
                        RowIndex: 0
                        RowSpan: 6
                      - ColumnIndex: 27
                        ColumnSpan: 9
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_0c2596db-18a1-4a0d-a6ae-dd1026009096
                        ElementType: VISUAL
                        RowIndex: 0
                        RowSpan: 6
                      - ColumnIndex: 0
                        ColumnSpan: 36
                        ElementId: b923504a-81d4-4756-a02a-a19c5fb145f8
                        ElementType: TEXT_BOX
                        RowIndex: 6
                        RowSpan: 1
                      - ColumnIndex: 0
                        ColumnSpan: 14
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_6efe3eb4-6723-437a-923a-9ae01f2cf7b6
                        ElementType: VISUAL
                        RowIndex: 7
                        RowSpan: 10
                      - ColumnIndex: 14
                        ColumnSpan: 22
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_78baa579-f56d-45ba-8447-13adeae0f175
                        ElementType: VISUAL
                        RowIndex: 7
                        RowSpan: 10
                      - ColumnIndex: 0
                        ColumnSpan: 36
                        ElementId: e9816258-04a9-4c17-a25a-b0e33cd5619b
                        ElementType: TEXT_BOX
                        RowIndex: 17
                        RowSpan: 1
                      - ColumnIndex: 0
                        ColumnSpan: 14
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_98f2dc05-ac04-48d2-bf21-03ccbc21aee9
                        ElementType: VISUAL
                        RowIndex: 18
                        RowSpan: 11
                      - ColumnIndex: 14
                        ColumnSpan: 22
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_90337c12-10ec-43c4-8e4f-896d8725970a
                        ElementType: VISUAL
                        RowIndex: 18
                        RowSpan: 11
                      - ColumnIndex: 0
                        ColumnSpan: 36
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_589cd311-5147-4c86-b78e-57145d94e401
                        ElementType: VISUAL
                        RowIndex: 29
                        RowSpan: 12
            Name: RDS Instance Snapshot
            ParameterControls:
              - List:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SearchOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: HIDDEN
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: EXTRA_LARGE
                      Visibility: VISIBLE
                  ParameterControlId: 910869d4-2749-4848-a10b-dc998ab07688
                  SelectableValues:
                    Values:
                      - Daily
                      - Monthly
                      - Quarterly
                      - Yearly
                  SourceParameterName: Periodstarting
                  Title: Period
                  Type: SINGLE_SELECT
            SheetControlLayouts:
              - Configuration:
                  GridLayout:
                    Elements: []
            SheetId: >-
              beb20665-db4e-4a39-b684-a8a7761bc008_a0917b74-2677-4361-871b-9ce2432acad1
            TextBoxes:
              - Content: |-
                  <text-box>
                    <block align="center">
                      <inline font-size="18px">
                        <b>
                          <u>Region Distribution</u>
                        </b>
                      </inline>
                    </block>
                  </text-box>
                SheetTextBoxId: b923504a-81d4-4756-a02a-a19c5fb145f8
              - Content: |-
                  <text-box>
                    <block align="center">
                      <inline font-size="18px">
                        <b>
                          <u>Size Distribution</u>
                        </b>
                      </inline>
                    </block>
                  </text-box>
                SheetTextBoxId: e9816258-04a9-4c17-a25a-b0e33cd5619b
            Visuals:
              - LineChartVisual:
                  Actions: []
                  ChartConfiguration:
                    DataLabels:
                      Overlap: ENABLE_OVERLAP
                      Visibility: VISIBLE
                    FieldWells:
                      LineChartAggregatedFieldWells:
                        Category:
                          - DateDimensionField:
                              Column:
                                ColumnName: rds_ins_trend_period
                                DataSetIdentifier: rds_ins_trend
                              DateGranularity: DAY
                              FieldId: >-
                                7a57fd79-340c-4ace-b82e-33ed521709b7.0.1706255511189
                              HierarchyId: e4154d32-34dd-423a-b221-95dcedd0f7c1
                        Colors: []
                        Values:
                          - CategoricalMeasureField:
                              AggregationFunction: DISTINCT_COUNT
                              Column:
                                ColumnName: snapshot_dbsnapshotidentifier
                                DataSetIdentifier: rds_ins_trend
                              FieldId: >-
                                39ba9443-440d-432b-878f-eab88bf70a4d.snapshot_dbsnapshotidentifier.1.1706255708332
                    PrimaryYAxisDisplayOptions:
                      AxisOptions:
                        GridLineVisibility: HIDDEN
                      MissingDataConfigurations:
                        - TreatmentOption: INTERPOLATE
                    Series:
                      - FieldSeriesItem:
                          AxisBinding: PRIMARY_YAXIS
                          FieldId: >-
                            39ba9443-440d-432b-878f-eab88bf70a4d.snapshot_dbsnapshotidentifier.1.1706255708332
                          Settings:
                            LineStyleSettings:
                              LineInterpolation: SMOOTH
                            MarkerStyleSettings:
                              MarkerColor: '#DE3B00'
                              MarkerShape: ROUNDED_SQUARE
                              MarkerVisibility: VISIBLE
                    SortConfiguration:
                      CategoryItemsLimitConfiguration:
                        OtherCategories: INCLUDE
                      CategorySort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              7a57fd79-340c-4ace-b82e-33ed521709b7.0.1706255511189
                      ColorItemsLimitConfiguration:
                        OtherCategories: INCLUDE
                      SmallMultiplesLimitConfiguration:
                        OtherCategories: INCLUDE
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                7a57fd79-340c-4ace-b82e-33ed521709b7.0.1706255511189
                              Label: Period
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                39ba9443-440d-432b-878f-eab88bf70a4d.snapshot_dbsnapshotidentifier.1.1706255708332
                              Label: Snapshot Count
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                    Type: LINE
                    VisualPalette:
                      ColorMap:
                        - Color: '#9FDEF1'
                          Element:
                            FieldId: >-
                              39ba9443-440d-432b-878f-eab88bf70a4d.snapshot_dbsnapshotidentifier.1.1706255708332
                            FieldValue: snapshot_dbsnapshotidentifier
                    XAxisDisplayOptions:
                      DataOptions:
                        DateAxisOptions:
                          MissingDateVisibility: HIDDEN
                  ColumnHierarchies:
                    - DateTimeHierarchy:
                        DrillDownFilters: []
                        HierarchyId: e4154d32-34dd-423a-b221-95dcedd0f7c1
                  Subtitle:
                    FormatText:
                      RichText: >-
                        <visual-subtitle>RDS Instance Orphan Snapshot
                        Count</visual-subtitle>
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>
                            <parameter>${Periodstarting}</parameter>
                          </b>
                          <b> Trend</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_39bded3b-a844-43ba-aa49-ea4019221ade
              - PieChartVisual:
                  Actions:
                    - ActionOperations:
                        - FilterOperation:
                            SelectedFieldsConfiguration:
                              SelectedFieldOptions: ALL_FIELDS
                            TargetVisualsConfiguration:
                              SameSheetTargetVisualConfiguration:
                                TargetVisuals:
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_589cd311-5147-4c86-b78e-57145d94e401
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_78baa579-f56d-45ba-8447-13adeae0f175
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_6efe3eb4-6723-437a-923a-9ae01f2cf7b6
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_90337c12-10ec-43c4-8e4f-896d8725970a
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_98f2dc05-ac04-48d2-bf21-03ccbc21aee9
                      CustomActionId: 98630a5a-296f-4aba-a698-77238f5f1e73
                      Name: DB Engine
                      Status: ENABLED
                      Trigger: DATA_POINT_CLICK
                  ChartConfiguration:
                    CategoryLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: snapshot_engine
                              DataSetIdentifier: rds_ins_view
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engine.0.1705817592320
                          CustomLabel: DB Engine
                    DataLabels:
                      CategoryLabelVisibility: VISIBLE
                      MeasureLabelVisibility: VISIBLE
                      Overlap: ENABLE_OVERLAP
                      Visibility: VISIBLE
                    DonutOptions:
                      ArcOptions:
                        ArcThickness: MEDIUM
                    FieldWells:
                      PieChartAggregatedFieldWells:
                        Category:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_engine
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engine.0.1705817592320
                        Values: []
                    Legend:
                      Title:
                        Visibility: HIDDEN
                      Visibility: HIDDEN
                    SortConfiguration:
                      CategoryItemsLimit:
                        ItemsLimit: 10
                        OtherCategories: INCLUDE
                      SmallMultiplesLimitConfiguration:
                        OtherCategories: INCLUDE
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engine.0.1705817592320
                              Label: RDS Engine
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engine.0.1705817592320
                              Label: Count
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                  ColumnHierarchies: []
                  Subtitle:
                    FormatText:
                      RichText: <visual-subtitle>Current Month</visual-subtitle>
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>RDS Engine</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_0c2596db-18a1-4a0d-a6ae-dd1026009096
              - TableVisual:
                  Actions: []
                  ChartConfiguration:
                    FieldOptions:
                      Order:
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705817838964
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.region.12.1705843150743
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705817868101
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_snapshotcreatetime.8.1705817897645
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_availabilityzone.4.1705817875672
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_status.10.1705817903329
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbinstanceidentifier.3.1705817870916
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engine.5.1705817889575
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engineversion.6.1705817891504
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_instancecreatetime.7.1705817894179
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_vpcid.9.1705817899683
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_port.12.1705817943754
                        - >-
                          cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.11.1705817938805
                      SelectedFieldOptions:
                        - CustomLabel: Account
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705817838964
                          Width: 219px
                        - CustomLabel: Region
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.region.12.1705843150743
                        - CustomLabel: Snapshot Identifier
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705817868101
                          Width: 233px
                        - CustomLabel: Snapshot Create Time
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_snapshotcreatetime.8.1705817897645
                        - CustomLabel: Snapshot AZs
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_availabilityzone.4.1705817875672
                        - CustomLabel: Status
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_status.10.1705817903329
                        - CustomLabel: RDS Identifier
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbinstanceidentifier.3.1705817870916
                        - CustomLabel: RDS Engine
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engine.5.1705817889575
                          Width: 123px
                        - CustomLabel: Version
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engineversion.6.1705817891504
                          Width: 71px
                        - CustomLabel: RDS Create Time
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_instancecreatetime.7.1705817894179
                          Width: 115px
                        - CustomLabel: VPC
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_vpcid.9.1705817899683
                          Width: 114px
                        - CustomLabel: Port
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_port.12.1705817943754
                        - CustomLabel: Allocated Storage(GB)
                          FieldId: >-
                            cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.11.1705817938805
                    FieldWells:
                      TableAggregatedFieldWells:
                        GroupBy:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705817838964
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: region
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.region.12.1705843150743
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_dbsnapshotidentifier
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705817868101
                          - DateDimensionField:
                              Column:
                                ColumnName: snapshot_snapshotcreatetime
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_snapshotcreatetime.8.1705817897645
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_availabilityzone
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_availabilityzone.4.1705817875672
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_status
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_status.10.1705817903329
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_dbinstanceidentifier
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbinstanceidentifier.3.1705817870916
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_engine
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engine.5.1705817889575
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_engineversion
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_engineversion.6.1705817891504
                          - DateDimensionField:
                              Column:
                                ColumnName: snapshot_instancecreatetime
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_instancecreatetime.7.1705817894179
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_vpcid
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_vpcid.9.1705817899683
                          - NumericalDimensionField:
                              Column:
                                ColumnName: snapshot_port
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_port.12.1705817943754
                              FormatConfiguration:
                                FormatConfiguration:
                                  NumberDisplayFormatConfiguration:
                                    DecimalPlacesConfiguration:
                                      DecimalPlaces: 0
                                    NullValueFormatConfiguration:
                                      NullString: 'null'
                                    SeparatorConfiguration:
                                      ThousandsSeparator:
                                        Visibility: HIDDEN
                        Values:
                          - NumericalMeasureField:
                              AggregationFunction:
                                SimpleNumericalAggregation: SUM
                              Column:
                                ColumnName: snapshot_allocatedstorage
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.11.1705817938805
                              FormatConfiguration:
                                FormatConfiguration:
                                  NumberDisplayFormatConfiguration:
                                    NullValueFormatConfiguration:
                                      NullString: 'null'
                                    NumberScale: AUTO
                                    SeparatorConfiguration:
                                      ThousandsSeparator:
                                        Symbol: COMMA
                                        Visibility: VISIBLE
                    SortConfiguration:
                      PaginationConfiguration:
                        PageNumber: 1
                        PageSize: 100
                      RowSort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.11.1705817938805
                    TableOptions:
                      HeaderStyle:
                        Height: 25
                        HorizontalTextAlignment: CENTER
                        TextWrap: WRAP
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>RDS Instance Snapshot Details</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_589cd311-5147-4c86-b78e-57145d94e401
              - BarChartVisual:
                  Actions: []
                  ChartConfiguration:
                    BarsArrangement: STACKED
                    CategoryLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: account_name
                              DataSetIdentifier: rds_ins_view
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705818741844
                          CustomLabel: Account
                    DataLabels:
                      Overlap: ENABLE_OVERLAP
                      TotalsVisibility: VISIBLE
                      Visibility: VISIBLE
                    FieldWells:
                      BarChartAggregatedFieldWells:
                        Category:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705818741844
                        Colors:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: region
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.region.2.1705842212658
                        Values:
                          - CategoricalMeasureField:
                              AggregationFunction: DISTINCT_COUNT
                              Column:
                                ColumnName: snapshot_dbsnapshotidentifier
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705818803743
                              FormatConfiguration:
                                NumericFormatConfiguration:
                                  NumberDisplayFormatConfiguration:
                                    DecimalPlacesConfiguration:
                                      DecimalPlaces: 0
                                    NullValueFormatConfiguration:
                                      NullString: 'null'
                                    SeparatorConfiguration:
                                      ThousandsSeparator:
                                        Visibility: HIDDEN
                    Legend:
                      Height: 39px
                      Position: TOP
                      Title:
                        Visibility: HIDDEN
                    Orientation: VERTICAL
                    SortConfiguration:
                      CategoryItemsLimit:
                        OtherCategories: INCLUDE
                      CategorySort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705818741844
                      ColorItemsLimit:
                        OtherCategories: INCLUDE
                      SmallMultiplesLimitConfiguration:
                        OtherCategories: INCLUDE
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705818741844
                              Label: Account
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705818803743
                              Label: Snapshot Count
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.region.2.1705842212658
                              Label: Region
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                    ValueAxis:
                      TickLabelOptions:
                        LabelOptions:
                          Visibility: VISIBLE
                    ValueLabelOptions:
                      Visibility: HIDDEN
                  ColumnHierarchies: []
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>Snapshot per Account &amp; Region</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_78baa579-f56d-45ba-8447-13adeae0f175
              - SankeyDiagramVisual:
                  Actions: []
                  ChartConfiguration:
                    DataLabels:
                      Overlap: DISABLE_OVERLAP
                      Visibility: VISIBLE
                    FieldWells:
                      SankeyDiagramAggregatedFieldWells:
                        Destination:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: region
                                DataSetIdentifier: rds_ins_trend
                              FieldId: >-
                                39ba9443-440d-432b-878f-eab88bf70a4d.region.1.1705819489843
                        Source:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_ins_trend
                              FieldId: >-
                                39ba9443-440d-432b-878f-eab88bf70a4d.account_name.0.1705819318582
                        Weight: []
                    SortConfiguration:
                      DestinationItemsLimit:
                        ItemsLimit: 10
                        OtherCategories: INCLUDE
                      SourceItemsLimit:
                        ItemsLimit: 10
                        OtherCategories: INCLUDE
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>Snapshot Distribution</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_6efe3eb4-6723-437a-923a-9ae01f2cf7b6
              - BarChartVisual:
                  Actions: []
                  ChartConfiguration:
                    BarsArrangement: STACKED
                    CategoryLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: account_name
                              DataSetIdentifier: rds_ins_view
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705819628255
                          CustomLabel: Account
                    DataLabels:
                      Overlap: DISABLE_OVERLAP
                      TotalsVisibility: VISIBLE
                      Visibility: VISIBLE
                    FieldWells:
                      BarChartAggregatedFieldWells:
                        Category:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705819628255
                        Colors:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_dbsnapshotidentifier
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705819648483
                        Values:
                          - NumericalMeasureField:
                              AggregationFunction:
                                SimpleNumericalAggregation: SUM
                              Column:
                                ColumnName: snapshot_allocatedstorage
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.1.1705819640614
                              FormatConfiguration:
                                FormatConfiguration:
                                  NumberDisplayFormatConfiguration:
                                    NullValueFormatConfiguration:
                                      NullString: 'null'
                                    NumberScale: AUTO
                                    SeparatorConfiguration:
                                      ThousandsSeparator:
                                        Symbol: COMMA
                                        Visibility: VISIBLE
                                    Suffix: ' GB'
                    Legend:
                      Position: TOP
                      Title:
                        Visibility: HIDDEN
                    Orientation: VERTICAL
                    SortConfiguration:
                      CategoryItemsLimit:
                        OtherCategories: INCLUDE
                      CategorySort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705819628255
                      ColorItemsLimit:
                        OtherCategories: INCLUDE
                      SmallMultiplesLimitConfiguration:
                        OtherCategories: INCLUDE
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705819628255
                              Label: Account
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.1.1705819640614
                              Label: Storage(GB)
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705819648483
                              Label: Snapshot
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                    ValueLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: snapshot_allocatedstorage
                              DataSetIdentifier: rds_ins_view
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.1.1705819640614
                          CustomLabel: Storage
                      Visibility: HIDDEN
                  ColumnHierarchies: []
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>Snapshot by Volume Size Distribution</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_90337c12-10ec-43c4-8e4f-896d8725970a
              - KPIVisual:
                  Actions: []
                  ChartConfiguration:
                    FieldWells:
                      TargetValues: []
                      TrendGroups:
                        - DateDimensionField:
                            Column:
                              ColumnName: file_crt_dt
                              DataSetIdentifier: rds_ins_trend
                            FieldId: >-
                              39ba9443-440d-432b-878f-eab88bf70a4d.file_crt_dt.1.1705820119025
                            HierarchyId: 85345a79-f024-4623-b753-5f3e7198d792
                      Values:
                        - CategoricalMeasureField:
                            AggregationFunction: DISTINCT_COUNT
                            Column:
                              ColumnName: snapshot_dbsnapshotidentifier
                              DataSetIdentifier: rds_ins_trend
                            FieldId: >-
                              39ba9443-440d-432b-878f-eab88bf70a4d.snapshot_dbsnapshotidentifier.0.1705820102122
                    KPIOptions:
                      Comparison:
                        ComparisonMethod: PERCENT_DIFFERENCE
                      PrimaryValueDisplayType: COMPARISON
                      SecondaryValueFontConfiguration:
                        FontColor: '#212121'
                        FontSize:
                          Relative: MEDIUM
                      Sparkline:
                        TooltipVisibility: HIDDEN
                        Type: AREA
                        Visibility: VISIBLE
                      VisualLayoutOptions:
                        StandardLayout:
                          Type: CLASSIC
                    SortConfiguration:
                      TrendGroupSort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              39ba9443-440d-432b-878f-eab88bf70a4d.file_crt_dt.1.1705820119025
                  ColumnHierarchies:
                    - DateTimeHierarchy:
                        DrillDownFilters: []
                        HierarchyId: 85345a79-f024-4623-b753-5f3e7198d792
                  ConditionalFormatting:
                    ConditionalFormattingOptions:
                      - ComparisonValue:
                          TextColor:
                            Solid:
                              Color: '#2CAD00'
                              Expression: >-
                                percentDifference(DISTINCT_COUNT({snapshot_dbsnapshotidentifier}),[DISTINCT_COUNT({snapshot_dbsnapshotidentifier})
                                DESC],1,[]) > 0.0
                      - ComparisonValue:
                          TextColor:
                            Solid:
                              Color: '#DE3B00'
                              Expression: >-
                                percentDifference(DISTINCT_COUNT({snapshot_dbsnapshotidentifier}),[DISTINCT_COUNT({snapshot_dbsnapshotidentifier})
                                DESC],1,[]) < 0.0
                      - ComparisonValue:
                          Icon:
                            CustomCondition:
                              Color: '#2CAD00'
                              Expression: >-
                                percentDifference(DISTINCT_COUNT({snapshot_dbsnapshotidentifier}),[DISTINCT_COUNT({snapshot_dbsnapshotidentifier})
                                DESC],1,[]) > 0.0
                              IconOptions:
                                Icon: CARET_UP
                      - ComparisonValue:
                          Icon:
                            CustomCondition:
                              Color: '#DE3B00'
                              Expression: >-
                                percentDifference(DISTINCT_COUNT({snapshot_dbsnapshotidentifier}),[DISTINCT_COUNT({snapshot_dbsnapshotidentifier})
                                DESC],1,[]) < 0.0
                              IconOptions:
                                Icon: CARET_DOWN
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>KPI Trend</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_c390aa1b-4e4a-4f50-be02-c9fc85813d46
              - TreeMapVisual:
                  Actions: []
                  ChartConfiguration:
                    ColorLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: snapshot_dbsnapshotidentifier
                              DataSetIdentifier: rds_ins_view
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705845976642
                          CustomLabel: Snapshot Count
                    ColorScale:
                      ColorFillType: DISCRETE
                      Colors:
                        - {}
                        - {}
                    DataLabels:
                      Overlap: DISABLE_OVERLAP
                      Visibility: VISIBLE
                    FieldWells:
                      TreeMapAggregatedFieldWells:
                        Colors:
                          - CategoricalMeasureField:
                              AggregationFunction: COUNT
                              Column:
                                ColumnName: snapshot_dbsnapshotidentifier
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705845976642
                        Groups:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705845966792
                        Sizes:
                          - NumericalMeasureField:
                              AggregationFunction:
                                SimpleNumericalAggregation: SUM
                              Column:
                                ColumnName: snapshot_allocatedstorage
                                DataSetIdentifier: rds_ins_view
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.1.1705845970704
                    GroupLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: account_name
                              DataSetIdentifier: rds_ins_view
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705845966792
                          CustomLabel: Account
                    Legend:
                      Visibility: HIDDEN
                    SizeLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: snapshot_allocatedstorage
                              DataSetIdentifier: rds_ins_view
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.1.1705845970704
                          CustomLabel: Size
                    SortConfiguration:
                      TreeMapGroupItemsLimitConfiguration:
                        OtherCategories: INCLUDE
                      TreeMapSort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.1.1705845970704
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.account_name.0.1705845966792
                              Label: Account
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_allocatedstorage.1.1705845970704
                              Label: Size (GB)
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                cf1e9f68-3a22-4aee-9bad-f2bf87e9344c.snapshot_dbsnapshotidentifier.2.1705845976642
                              Label: Snapshot Count
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                  ColumnHierarchies: []
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>Snapshot by Volume Size Distribution - Tree</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_98f2dc05-ac04-48d2-bf21-03ccbc21aee9
          - ContentType: INTERACTIVE
            FilterControls:
              - RelativeDateTime:
                  DisplayOptions:
                    DateTimeFormat: 'YYYY/MM/DD HH:mm:ss'
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: 68f0abc1-02dc-4e02-9005-9240cf446a65
                  SourceFilterId: bd15900c-501c-4e6d-988a-8594514fd224
                  Title: Snapshot Create Time
              - RelativeDateTime:
                  DisplayOptions:
                    DateTimeFormat: 'YYYY/MM/DD HH:mm:ss'
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: a37d203d-42e4-4143-9ffa-5aa97934b3b4
                  SourceFilterId: 896ccf81-62dc-4754-9c7b-213102f54a80
                  Title: DB Create Time
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: e26a4cef-5d3e-4402-9395-d5922c17beb6
                  SourceFilterId: cfed512d-52f3-4a72-832f-08c7ebec16cd
                  Title: Account
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: 6ee858cb-afcd-4bb8-8756-23a0fcc28f4b
                  SourceFilterId: d60fd5f9-ad99-4950-831b-e8ac61fda633
                  Title: Region
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: fe5cb643-1289-4b1f-8277-33071056ab82
                  SourceFilterId: 607c33cc-8f75-49ff-9367-5c4e45c0a219
                  Title: Snapshot Identifier
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: 0b36bc97-510c-40d9-b738-226ed8f37103
                  SourceFilterId: a62273ea-7ea7-452b-bf9d-e0de0f353f45
                  Title: DB Identifier
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: a8e70127-7a69-4b94-a354-656bd4c10f97
                  SourceFilterId: f6705523-302f-49a7-b648-bb7738bf58ea
                  Title: DB Engine
                  Type: MULTI_SELECT
              - Dropdown:
                  DisplayOptions:
                    InfoIconLabelOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: VISIBLE
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  FilterControlId: ca9c0dbe-be14-431f-b1f8-3210c31dde4d
                  SourceFilterId: e71d6196-cc63-4bfb-a280-2a7009d54134
                  Title: DB Engine Mode
                  Type: MULTI_SELECT
            Layouts:
              - Configuration:
                  GridLayout:
                    CanvasSizeOptions:
                      ScreenCanvasSizeOptions:
                        OptimizedViewPortWidth: 1600px
                        ResizeOption: FIXED
                    Elements:
                      - ColumnIndex: 0
                        ColumnSpan: 18
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_58cf101c-5f6e-46f6-952f-3cf23f2a6af2
                        ElementType: VISUAL
                        RowIndex: 0
                        RowSpan: 6
                      - ColumnIndex: 18
                        ColumnSpan: 3
                        ElementId: 0caf5a9f-fb91-4658-8778-bfce52b52fb9
                        ElementType: PARAMETER_CONTROL
                        RowIndex: 0
                        RowSpan: 6
                      - ColumnIndex: 21
                        ColumnSpan: 6
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_b8b5bce9-cf89-4bce-a090-aa814c06906c
                        ElementType: VISUAL
                        RowIndex: 0
                        RowSpan: 6
                      - ColumnIndex: 27
                        ColumnSpan: 9
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_8812c860-849d-439c-8803-3ad05e289d22
                        ElementType: VISUAL
                        RowIndex: 0
                        RowSpan: 6
                      - ColumnIndex: 0
                        ColumnSpan: 36
                        ElementId: bbdd34a7-6036-4098-8097-43457e251c3f
                        ElementType: TEXT_BOX
                        RowIndex: 6
                        RowSpan: 1
                      - ColumnIndex: 0
                        ColumnSpan: 14
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_4e63be09-5b7a-4520-8e04-a112bada576b
                        ElementType: VISUAL
                        RowIndex: 7
                        RowSpan: 10
                      - ColumnIndex: 14
                        ColumnSpan: 22
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_701f6513-8c2e-4618-8d9a-8120213f3f29
                        ElementType: VISUAL
                        RowIndex: 7
                        RowSpan: 10
                      - ColumnIndex: 0
                        ColumnSpan: 36
                        ElementId: 1ec55d34-f808-4615-a101-94b7d7c7f85e
                        ElementType: TEXT_BOX
                        RowIndex: 17
                        RowSpan: 1
                      - ColumnIndex: 0
                        ColumnSpan: 14
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_2f8dcd26-b810-4329-8a15-d40f76ed4cad
                        ElementType: VISUAL
                        RowIndex: 18
                        RowSpan: 11
                      - ColumnIndex: 14
                        ColumnSpan: 22
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_33bc9e9e-2b16-4df1-b242-3670c833f3e0
                        ElementType: VISUAL
                        RowIndex: 18
                        RowSpan: 11
                      - ColumnIndex: 0
                        ColumnSpan: 36
                        ElementId: >-
                          beb20665-db4e-4a39-b684-a8a7761bc008_71f7d041-6f65-46bc-b123-fc67d9a0790a
                        ElementType: VISUAL
                        RowIndex: 29
                        RowSpan: 12
            Name: RDS Cluster Snapshot
            ParameterControls:
              - List:
                  DisplayOptions:
                    SearchOptions:
                      Visibility: HIDDEN
                    SelectAllOptions:
                      Visibility: HIDDEN
                    TitleOptions:
                      FontConfiguration:
                        FontSize:
                          Relative: MEDIUM
                      Visibility: VISIBLE
                  ParameterControlId: 0caf5a9f-fb91-4658-8778-bfce52b52fb9
                  SelectableValues:
                    Values:
                      - Daily
                      - Monthly
                      - Quarterly
                      - Yearly
                  SourceParameterName: Periodstarting
                  Title: Period
                  Type: SINGLE_SELECT
            SheetControlLayouts:
              - Configuration:
                  GridLayout:
                    Elements: []
            SheetId: >-
              beb20665-db4e-4a39-b684-a8a7761bc008_d6580acd-d214-4cb6-b954-062e5ed0bf74
            TextBoxes:
              - Content: |-
                  <text-box>
                    <block align="center">
                      <inline font-size="18px">
                        <b>
                          <u>Region Distribution</u>
                        </b>
                      </inline>
                    </block>
                  </text-box>
                SheetTextBoxId: 72bf0a70-9557-401b-8b40-c76fbd477348
              - Content: |-
                  <text-box>
                    <block align="center">
                      <inline font-size="18px">
                        <b>
                          <u>Region Distribution</u>
                        </b>
                      </inline>
                    </block>
                  </text-box>
                SheetTextBoxId: bbdd34a7-6036-4098-8097-43457e251c3f
              - Content: |-
                  <text-box>
                    <block align="center">
                      <inline font-size="18px">
                        <b>
                          <u>Size Distribution</u>
                        </b>
                      </inline>
                    </block>
                  </text-box>
                SheetTextBoxId: 1ec55d34-f808-4615-a101-94b7d7c7f85e
            Visuals:
              - LineChartVisual:
                  Actions: []
                  ChartConfiguration:
                    DataLabels:
                      Overlap: ENABLE_OVERLAP
                      Visibility: VISIBLE
                    FieldWells:
                      LineChartAggregatedFieldWells:
                        Category:
                          - DateDimensionField:
                              Column:
                                ColumnName: rds_cls_trend_period
                                DataSetIdentifier: rds_cls_trend
                              DateGranularity: DAY
                              FieldId: >-
                                0f4402d4-6302-4b71-8562-cfd6cc2839d4.1.1706255338120
                              HierarchyId: fd2dd912-9d59-40b1-be25-81ef220d2512
                        Colors: []
                        Values:
                          - CategoricalMeasureField:
                              AggregationFunction: DISTINCT_COUNT
                              Column:
                                ColumnName: snapshot_dbclustersnapshotidentifier
                                DataSetIdentifier: rds_cls_trend
                              FieldId: >-
                                7b30df56-cd21-40d7-ad99-f08b7456b09e.snapshot_dbclustersnapshotidentifier.1.1705840704807
                              FormatConfiguration:
                                NumericFormatConfiguration:
                                  NumberDisplayFormatConfiguration:
                                    DecimalPlacesConfiguration:
                                      DecimalPlaces: 0
                                    NullValueFormatConfiguration:
                                      NullString: 'null'
                                    SeparatorConfiguration:
                                      DecimalSeparator: DOT
                                      ThousandsSeparator:
                                        Symbol: COMMA
                                        Visibility: HIDDEN
                    PrimaryYAxisDisplayOptions:
                      AxisOptions:
                        GridLineVisibility: HIDDEN
                      MissingDataConfigurations:
                        - TreatmentOption: INTERPOLATE
                    PrimaryYAxisLabelOptions:
                      Visibility: HIDDEN
                    Series:
                      - FieldSeriesItem:
                          AxisBinding: PRIMARY_YAXIS
                          FieldId: >-
                            7b30df56-cd21-40d7-ad99-f08b7456b09e.snapshot_dbclustersnapshotidentifier.1.1705840704807
                          Settings:
                            LineStyleSettings:
                              LineInterpolation: SMOOTH
                            MarkerStyleSettings:
                              MarkerColor: '#DE3B00'
                              MarkerShape: ROUNDED_SQUARE
                              MarkerVisibility: VISIBLE
                    SortConfiguration:
                      CategoryItemsLimitConfiguration:
                        OtherCategories: INCLUDE
                      CategorySort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              0f4402d4-6302-4b71-8562-cfd6cc2839d4.1.1706255338120
                      ColorItemsLimitConfiguration:
                        OtherCategories: INCLUDE
                      SmallMultiplesLimitConfiguration:
                        OtherCategories: INCLUDE
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                7b30df56-cd21-40d7-ad99-f08b7456b09e.snapshot_dbclustersnapshotidentifier.1.1705840704807
                              Label: Snapshot Count
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                0f4402d4-6302-4b71-8562-cfd6cc2839d4.1.1706255338120
                              Label: Period
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                    Type: LINE
                    VisualPalette:
                      ColorMap:
                        - Color: '#9FDEF1'
                          Element:
                            FieldId: >-
                              7b30df56-cd21-40d7-ad99-f08b7456b09e.snapshot_dbclustersnapshotidentifier.1.1705840704807
                            FieldValue: snapshot_dbclustersnapshotidentifier
                    XAxisDisplayOptions:
                      DataOptions:
                        DateAxisOptions:
                          MissingDateVisibility: HIDDEN
                      ScrollbarOptions:
                        Visibility: VISIBLE
                  ColumnHierarchies:
                    - DateTimeHierarchy:
                        DrillDownFilters: []
                        HierarchyId: fd2dd912-9d59-40b1-be25-81ef220d2512
                  Subtitle:
                    FormatText:
                      RichText: >-
                        <visual-subtitle>RDS Cluster Orphan Snapshot
                        Count</visual-subtitle>
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>
                            <parameter>${Periodstarting}</parameter>
                          </b>
                          <b> Trend</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_58cf101c-5f6e-46f6-952f-3cf23f2a6af2
              - KPIVisual:
                  Actions: []
                  ChartConfiguration:
                    FieldWells:
                      TargetValues: []
                      TrendGroups:
                        - DateDimensionField:
                            Column:
                              ColumnName: file_crt_dt
                              DataSetIdentifier: rds_cls_trend
                            DateGranularity: DAY
                            FieldId: >-
                              7b30df56-cd21-40d7-ad99-f08b7456b09e.file_crt_dt.0.1705841556596
                            HierarchyId: 64817782-9e3d-4341-b61d-4a1d599cd9a4
                      Values:
                        - CategoricalMeasureField:
                            AggregationFunction: DISTINCT_COUNT
                            Column:
                              ColumnName: snapshot_dbclustersnapshotidentifier
                              DataSetIdentifier: rds_cls_trend
                            FieldId: >-
                              7b30df56-cd21-40d7-ad99-f08b7456b09e.snapshot_dbclustersnapshotidentifier.1.1705841576174
                    KPIOptions:
                      Comparison:
                        ComparisonMethod: PERCENT_DIFFERENCE
                      PrimaryValueDisplayType: COMPARISON
                      SecondaryValueFontConfiguration:
                        FontColor: '#212121'
                        FontSize:
                          Relative: MEDIUM
                      Sparkline:
                        TooltipVisibility: HIDDEN
                        Type: AREA
                        Visibility: VISIBLE
                      VisualLayoutOptions:
                        StandardLayout:
                          Type: CLASSIC
                    SortConfiguration:
                      TrendGroupSort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              7b30df56-cd21-40d7-ad99-f08b7456b09e.file_crt_dt.0.1705841556596
                  ColumnHierarchies:
                    - DateTimeHierarchy:
                        DrillDownFilters: []
                        HierarchyId: 64817782-9e3d-4341-b61d-4a1d599cd9a4
                  ConditionalFormatting:
                    ConditionalFormattingOptions:
                      - ComparisonValue:
                          TextColor:
                            Solid:
                              Color: '#2CAD00'
                              Expression: >-
                                percentDifference(DISTINCT_COUNT({snapshot_dbclustersnapshotidentifier}),[DISTINCT_COUNT({snapshot_dbclustersnapshotidentifier})
                                DESC],1,[]) > 0.0
                      - ComparisonValue:
                          TextColor:
                            Solid:
                              Color: '#DE3B00'
                              Expression: >-
                                percentDifference(DISTINCT_COUNT({snapshot_dbclustersnapshotidentifier}),[DISTINCT_COUNT({snapshot_dbclustersnapshotidentifier})
                                DESC],1,[]) < 0.0
                      - ComparisonValue:
                          Icon:
                            CustomCondition:
                              Color: '#2CAD00'
                              Expression: >-
                                percentDifference(DISTINCT_COUNT({snapshot_dbclustersnapshotidentifier}),[DISTINCT_COUNT({snapshot_dbclustersnapshotidentifier})
                                DESC],1,[]) > 0.0
                              IconOptions:
                                Icon: CARET_UP
                      - ComparisonValue:
                          Icon:
                            CustomCondition:
                              Color: '#DE3B00'
                              Expression: >-
                                percentDifference(DISTINCT_COUNT({snapshot_dbclustersnapshotidentifier}),[DISTINCT_COUNT({snapshot_dbclustersnapshotidentifier})
                                DESC],1,[]) < 0.0
                              IconOptions:
                                Icon: CARET_DOWN
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>KPI Trend</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_b8b5bce9-cf89-4bce-a090-aa814c06906c
              - PieChartVisual:
                  Actions:
                    - ActionOperations:
                        - FilterOperation:
                            SelectedFieldsConfiguration:
                              SelectedFieldOptions: ALL_FIELDS
                            TargetVisualsConfiguration:
                              SameSheetTargetVisualConfiguration:
                                TargetVisuals:
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_701f6513-8c2e-4618-8d9a-8120213f3f29
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_4e63be09-5b7a-4520-8e04-a112bada576b
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_2f8dcd26-b810-4329-8a15-d40f76ed4cad
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_33bc9e9e-2b16-4df1-b242-3670c833f3e0
                                  - >-
                                    beb20665-db4e-4a39-b684-a8a7761bc008_71f7d041-6f65-46bc-b123-fc67d9a0790a
                      CustomActionId: cadb03b6-d138-4a65-8df6-acd72f707f80
                      Name: DB Engine
                      Status: ENABLED
                      Trigger: DATA_POINT_CLICK
                  ChartConfiguration:
                    DataLabels:
                      MeasureLabelVisibility: VISIBLE
                      Overlap: ENABLE_OVERLAP
                      Visibility: VISIBLE
                    DonutOptions:
                      ArcOptions:
                        ArcThickness: MEDIUM
                    FieldWells:
                      PieChartAggregatedFieldWells:
                        Category:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_engine
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_engine.0.1705841813708
                        Values: []
                    Legend:
                      Visibility: HIDDEN
                    SortConfiguration:
                      CategoryItemsLimit:
                        OtherCategories: INCLUDE
                      SmallMultiplesLimitConfiguration:
                        OtherCategories: INCLUDE
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_engine.0.1705841813708
                              Label: RDS Engine
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_engine.0.1705841813708
                              Label: Count
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                  ColumnHierarchies: []
                  Subtitle:
                    FormatText:
                      RichText: <visual-subtitle>Current Month</visual-subtitle>
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>RDS Engine</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_8812c860-849d-439c-8803-3ad05e289d22
              - BarChartVisual:
                  Actions: []
                  ChartConfiguration:
                    BarsArrangement: STACKED
                    CategoryLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: account_name
                              DataSetIdentifier: rds_cls_view
                            FieldId: >-
                              fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705842190480
                          CustomLabel: Account
                    DataLabels:
                      Overlap: DISABLE_OVERLAP
                      TotalsVisibility: VISIBLE
                      Visibility: VISIBLE
                    FieldWells:
                      BarChartAggregatedFieldWells:
                        Category:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705842190480
                        Colors:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: region
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.region.2.1705842238531
                        Values:
                          - CategoricalMeasureField:
                              AggregationFunction: DISTINCT_COUNT
                              Column:
                                ColumnName: snapshot_dbclustersnapshotidentifier
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclustersnapshotidentifier.1.1705842200761
                    Legend:
                      Height: 39px
                      Position: TOP
                      Title:
                        Visibility: HIDDEN
                      Visibility: VISIBLE
                      Width: 100px
                    Orientation: VERTICAL
                    SortConfiguration:
                      CategoryItemsLimit:
                        OtherCategories: INCLUDE
                      CategorySort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705842190480
                      ColorItemsLimit:
                        OtherCategories: INCLUDE
                      SmallMultiplesLimitConfiguration:
                        OtherCategories: INCLUDE
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705842190480
                              Label: Account
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.region.2.1705842238531
                              Label: Region
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclustersnapshotidentifier.1.1705842200761
                              Label: Snapshot Count
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                    ValueLabelOptions:
                      Visibility: HIDDEN
                  ColumnHierarchies: []
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>Snapshot per Account &amp; Region</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_701f6513-8c2e-4618-8d9a-8120213f3f29
              - SankeyDiagramVisual:
                  Actions: []
                  ChartConfiguration:
                    DataLabels:
                      Overlap: DISABLE_OVERLAP
                      Visibility: VISIBLE
                    FieldWells:
                      SankeyDiagramAggregatedFieldWells:
                        Destination:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: region
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.region.1.1705842445295
                        Source:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705842439864
                        Weight: []
                    SortConfiguration:
                      DestinationItemsLimit:
                        ItemsLimit: 10
                        OtherCategories: INCLUDE
                      SourceItemsLimit:
                        ItemsLimit: 10
                        OtherCategories: INCLUDE
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>Snapshot Distribution</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_4e63be09-5b7a-4520-8e04-a112bada576b
              - TreeMapVisual:
                  Actions: []
                  ChartConfiguration:
                    ColorLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: snapshot_dbclustersnapshotidentifier
                              DataSetIdentifier: rds_cls_view
                            FieldId: >-
                              fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclustersnapshotidentifier.2.1705845591970
                          CustomLabel: Snapshot Count
                    ColorScale:
                      ColorFillType: DISCRETE
                      Colors:
                        - {}
                        - {}
                    DataLabels:
                      Overlap: DISABLE_OVERLAP
                      Visibility: VISIBLE
                    FieldWells:
                      TreeMapAggregatedFieldWells:
                        Colors:
                          - CategoricalMeasureField:
                              AggregationFunction: DISTINCT_COUNT
                              Column:
                                ColumnName: snapshot_dbclustersnapshotidentifier
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclustersnapshotidentifier.2.1705845591970
                        Groups:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.2.1705845560934
                        Sizes:
                          - NumericalMeasureField:
                              AggregationFunction:
                                SimpleNumericalAggregation: SUM
                              Column:
                                ColumnName: snapshot_allocatedstorage
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_allocatedstorage.2.1705842808572
                              FormatConfiguration:
                                FormatConfiguration:
                                  NumberDisplayFormatConfiguration:
                                    NegativeValueConfiguration:
                                      DisplayMode: NEGATIVE
                                    NullValueFormatConfiguration:
                                      NullString: 'null'
                                    SeparatorConfiguration:
                                      DecimalSeparator: DOT
                                      ThousandsSeparator:
                                        Symbol: COMMA
                                        Visibility: VISIBLE
                    GroupLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: account_name
                              DataSetIdentifier: rds_cls_view
                            FieldId: >-
                              fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.2.1705845560934
                          CustomLabel: Account
                    Legend:
                      Visibility: HIDDEN
                    SizeLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: snapshot_allocatedstorage
                              DataSetIdentifier: rds_cls_view
                            FieldId: >-
                              fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_allocatedstorage.2.1705842808572
                          CustomLabel: Size (GB)
                    SortConfiguration:
                      TreeMapGroupItemsLimitConfiguration:
                        OtherCategories: INCLUDE
                      TreeMapSort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_allocatedstorage.2.1705842808572
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.2.1705845560934
                              Label: Account
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_allocatedstorage.2.1705842808572
                              Label: Size (GB)
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclustersnapshotidentifier.2.1705845591970
                              Label: Snapshot Count
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                  ColumnHierarchies: []
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>Snapshot by Volume Size Distribution - Tree</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_2f8dcd26-b810-4329-8a15-d40f76ed4cad
              - BarChartVisual:
                  Actions: []
                  ChartConfiguration:
                    BarsArrangement: STACKED
                    CategoryLabelOptions:
                      AxisLabelOptions:
                        - ApplyTo:
                            Column:
                              ColumnName: account_name
                              DataSetIdentifier: rds_cls_view
                            FieldId: >-
                              fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705843003669
                          CustomLabel: Account
                    DataLabels:
                      Overlap: ENABLE_OVERLAP
                      TotalsVisibility: VISIBLE
                      Visibility: VISIBLE
                    FieldWells:
                      BarChartAggregatedFieldWells:
                        Category:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705843003669
                        Colors:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_dbclustersnapshotidentifier
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclustersnapshotidentifier.2.1706346546224
                        Values:
                          - NumericalMeasureField:
                              AggregationFunction:
                                SimpleNumericalAggregation: SUM
                              Column:
                                ColumnName: snapshot_allocatedstorage
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_allocatedstorage.2.1705843017324
                              FormatConfiguration:
                                FormatConfiguration:
                                  NumberDisplayFormatConfiguration:
                                    NullValueFormatConfiguration:
                                      NullString: 'null'
                                    NumberScale: AUTO
                                    Suffix: ' GB'
                    Legend:
                      Height: 73px
                      Position: TOP
                      Title:
                        Visibility: HIDDEN
                      Visibility: VISIBLE
                    Orientation: VERTICAL
                    SortConfiguration:
                      CategoryItemsLimit:
                        OtherCategories: INCLUDE
                      CategorySort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705843003669
                      ColorItemsLimit:
                        OtherCategories: INCLUDE
                      SmallMultiplesLimitConfiguration:
                        OtherCategories: INCLUDE
                    Tooltip:
                      FieldBasedTooltip:
                        AggregationVisibility: HIDDEN
                        TooltipFields:
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705843003669
                              Label: Account
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_allocatedstorage.2.1705843017324
                              Label: Size (GB)
                              Visibility: VISIBLE
                          - FieldTooltipItem:
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclustersnapshotidentifier.2.1706346546224
                              Label: Snapshot
                              Visibility: VISIBLE
                        TooltipTitleType: PRIMARY_VALUE
                      SelectedTooltipType: DETAILED
                      TooltipVisibility: VISIBLE
                    ValueAxis:
                      TickLabelOptions:
                        LabelOptions:
                          Visibility: VISIBLE
                    ValueLabelOptions:
                      Visibility: HIDDEN
                  ColumnHierarchies: []
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>Snapshot by Volume Size Distribution</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_33bc9e9e-2b16-4df1-b242-3670c833f3e0
              - TableVisual:
                  Actions: []
                  ChartConfiguration:
                    FieldOptions:
                      Order: []
                      SelectedFieldOptions:
                        - CustomLabel: Account
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705843069529
                          Width: 200px
                        - CustomLabel: Region
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.region.1.1705843085269
                        - CustomLabel: Snapshot Identifier
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclustersnapshotidentifier.2.1705843090664
                          Width: 286px
                        - CustomLabel: Snapshot Create Time
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_snapshotcreatetime.3.1705843221047
                        - CustomLabel: Status
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_status.4.1705843233942
                          Width: 64px
                        - CustomLabel: RDS Identifier
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclusteridentifier.5.1705843248199
                          Width: 246px
                        - CustomLabel: RDS Engine
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_engine.6.1705843264436
                          Width: 95px
                        - CustomLabel: RDS Engine Mode
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_enginemode.7.1705843265577
                        - CustomLabel: RDS Create Time
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_clustercreatetime.8.1705843270411
                        - CustomLabel: VPC
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_vpcid.9.1705843273078
                          Width: 156px
                        - CustomLabel: Allocated Storage(GB)
                          FieldId: >-
                            fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_allocatedstorage.11.1705843293408
                    FieldWells:
                      TableAggregatedFieldWells:
                        GroupBy:
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: account_name
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.account_name.0.1705843069529
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: region
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.region.1.1705843085269
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_dbclustersnapshotidentifier
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclustersnapshotidentifier.2.1705843090664
                          - DateDimensionField:
                              Column:
                                ColumnName: snapshot_snapshotcreatetime
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_snapshotcreatetime.3.1705843221047
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_status
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_status.4.1705843233942
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_dbclusteridentifier
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_dbclusteridentifier.5.1705843248199
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_engine
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_engine.6.1705843264436
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_enginemode
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_enginemode.7.1705843265577
                          - DateDimensionField:
                              Column:
                                ColumnName: snapshot_clustercreatetime
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_clustercreatetime.8.1705843270411
                          - CategoricalDimensionField:
                              Column:
                                ColumnName: snapshot_vpcid
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_vpcid.9.1705843273078
                        Values:
                          - NumericalMeasureField:
                              AggregationFunction:
                                SimpleNumericalAggregation: SUM
                              Column:
                                ColumnName: snapshot_allocatedstorage
                                DataSetIdentifier: rds_cls_view
                              FieldId: >-
                                fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_allocatedstorage.11.1705843293408
                              FormatConfiguration:
                                FormatConfiguration:
                                  NumberDisplayFormatConfiguration:
                                    DecimalPlacesConfiguration:
                                      DecimalPlaces: 0
                                    NullValueFormatConfiguration:
                                      NullString: 'null'
                                    NumberScale: AUTO
                                    SeparatorConfiguration:
                                      ThousandsSeparator:
                                        Symbol: COMMA
                                        Visibility: VISIBLE
                    SortConfiguration:
                      PaginationConfiguration:
                        PageNumber: 1
                        PageSize: 100
                      RowSort:
                        - FieldSort:
                            Direction: DESC
                            FieldId: >-
                              fd10ea9f-db2b-4057-82f5-09d06cb6fe50.snapshot_allocatedstorage.11.1705843293408
                    TableOptions:
                      HeaderStyle:
                        Height: 25
                        HorizontalTextAlignment: CENTER
                        TextWrap: WRAP
                  Subtitle:
                    Visibility: VISIBLE
                  Title:
                    FormatText:
                      RichText: |-
                        <visual-title>
                          <b>RDS Cluster Snapshot Details</b>
                        </visual-title>
                    Visibility: VISIBLE
                  VisualId: >-
                    beb20665-db4e-4a39-b684-a8a7761bc008_71f7d041-6f65-46bc-b123-fc67d9a0790a
      Name: !Sub '${DashboardName}'
      Permissions:
        - Actions:
            - 'quicksight:DescribeDashboard'
            - 'quicksight:ListDashboardVersions'
            - 'quicksight:UpdateDashboardPermissions'
            - 'quicksight:QueryDashboard'
            - 'quicksight:UpdateDashboard'
            - 'quicksight:DeleteDashboard'
            - 'quicksight:DescribeDashboardPermissions'
            - 'quicksight:UpdateDashboardPublishedVersion'
          Principal: !Sub arn:${AWS::Partition}:quicksight:${QuicksightIdentityRegion}:${AWS::AccountId}:user/default/${QuicksightUserName}
      ThemeArn: !Sub 'arn:${AWS::Partition}:quicksight::aws:theme/CLASSIC'
      ValidationStrategy:
        Mode: LENIENT
     